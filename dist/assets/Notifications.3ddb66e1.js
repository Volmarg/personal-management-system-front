import{_ as t,aW as e,M as i,I as s,ae as o,r as a,o as n,e as l,f as r,t as d,h as u,aX as c,B as f}from"./index.5c1c3a9f.js";import{_ as h}from"./VuelidateHandler.ffbf1da4.js";import{c as m}from"./index.esm.6a4d3e5b.js";const p=t=>new RegExp(/http[s]?:\/\/(www.)?discord\.com\/api\/webhooks\//).test(t),b={class:"mt-10"},g={class:"text-lg mb-4"},k={class:"flex justify-center mt-10"},x={class:"md:w-1/2 lg:w-1/3 w-full flex flex-col"},V={class:"text-red-500 text-center mt-1"},C={class:"mb-2 flex flex-row hover:opacity-70 cursor-pointer mt-2"},v={class:"checkbox checkbox-all align-self-center ml-1 cursor-pointer"};var w=t({data:()=>({notification:{discordWebhook:"discordWebhook"},useCase:{reminder:"reminder"},loadedConfigs:[],inputPrefix:"configInput",inputValues:{},inputValidationErrors:{},usages:{}}),components:{Checkbox:e,MediumButtonWithIcon:i,VueInput:s},mixins:[h],computed:{inputValidations(){return{[this.notification.discordWebhook]:[m.withMessage(this.$t("systemSettings.tab.notifications.config.discordWebhook.input.validation.notValidUrl"),p)]}}},methods:{validate(){this.inputValidationErrors={};for(let t of Object.keys(this.inputValues)){let e=this.validateValue(this.inputValues[t],this.inputValidations[t]);e.length>0&&(this.inputValidationErrors[t]=e[0])}},getConfigData(t){let e=this.loadedConfigs.filter((e=>e.name===t));return e?e[0]:{name:t,value:"",activeForReminder:!1}},onSubmit(){if(Object.keys(this.inputValidationErrors).length>0)return;let t=Object.keys(this.$refs).filter((t=>t.includes(this.inputPrefix))),e=[];for(let o of t){let t=this.$refs[o].$el.getAttribute("data-type");e.push({name:t,value:this.inputValues[t],activeForReminder:this.usages[t][this.useCase.reminder]})}let i={configs:e},s=new c(o.SETTINGS_NOTIFICATIONS_CONFIG_BASE,null,f,i);s.reload=!1,this.$moduleCall.update(s)},async fetchConfigs(){var t,e;this.loadedConfigs=await this.$moduleCall.getAll(o.SETTINGS_NOTIFICATIONS_CONFIG_BASE);for(let i of Object.keys(this.notification)){let s=this.notification[i],o=this.getConfigData(s);this.inputValues[s]=null!=(t=null==o?void 0:o.value)?t:"",this.usages[s][this.useCase.reminder]=null!=(e=null==o?void 0:o.activeForReminder)&&e}}},beforeMount(){this.usages[this.notification.discordWebhook]={[this.useCase.reminder]:!1},this.fetchConfigs()},watch:{inputValues:{deep:!0,handler:function(){this.validate()}}}},[["render",function(t,e,i,s,o,c){const f=a("VueInput"),h=a("Checkbox"),m=a("MediumButtonWithIcon");return n(),l("div",b,[r("h2",g,d(t.$t("systemSettings.tab.notifications.configHeader")),1),r("div",k,[r("div",x,[u(f,{type:"text",label:t.$t("systemSettings.tab.notifications.config.discordWebhook.input.label"),"data-type":o.notification.discordWebhook,"top-wrapper-classes":"",ref:`${o.inputPrefix}_${o.notification.discordWebhook}`,modelValue:o.inputValues[o.notification.discordWebhook],"onUpdate:modelValue":e[0]||(e[0]=t=>o.inputValues[o.notification.discordWebhook]=t)},null,8,["label","data-type","modelValue"]),r("p",V,d(o.inputValidationErrors[o.notification.discordWebhook]),1),r("div",C,[u(h,{class:"transform scale-75",modelValue:o.usages[o.notification.discordWebhook][o.useCase.reminder],"onUpdate:modelValue":e[1]||(e[1]=t=>o.usages[o.notification.discordWebhook][o.useCase.reminder]=t)},null,8,["modelValue"]),r("label",v,d(t.$t("systemSettings.tab.notifications.config.discordWebhook.checkbox.label")),1)]),u(m,{text:t.$t("systemSettings.tab.notifications.button.submit.label"),disabled:Object.keys(o.inputValidationErrors).length>0,"button-extra-classes":"pt-3 pb-3 sm:pt-1 sm:pb-1",class:"w-full mb-1 md:col-start-1 md:col-end-2 mt-6 md:pr-0","button-classes":"w-full md:w-auto m-0-force","text-classes":"text-center w-full",onButtonClick:c.onSubmit},null,8,["text","disabled","onButtonClick"])])])])}]]);export{w as default};
