import{d as s,_ as e,s as o,V as i,T as a,S as t,b as r,A as l,I as d,M as n,r as m,o as u,e as h,f,t as c,h as w,j as g,k as p}from"./index.daf34ba3.js";import{_ as b}from"./ResponseHandlerMixin.69e9e767.js";import{_ as v,P as C}from"./PasswordWithConfirmation.81203bca.js";import{u as P,_ as x}from"./VuelidateHandler.c5fcca12.js";import{c as k,r as y,e as $}from"./index.esm.074fc502.js";const R={"data-layout":"centered",class:"w-full flex items-center justify-center bg-gray-50 pt-10 pb-10"},F={class:"flex flex-col bg-white border border-gray-200 p-8 w-full max-w-2xl"},q={class:"flex flex-col w-full mb-4"},V={class:"text-xs uppercase"},_={class:"flex flex-col"},D={class:"form flex flex-wrap w-full"},E={class:"w-full"},L={class:"two-inputs-per-row"},S={class:"flex flex-col sm:flex-row w-full mt-2 mb-2"},T={class:"flex flex-row w-full mt-1"},I={class:"text-secondary mr-1"};var M=e({setup:()=>({v$:P()}),data:()=>({form:{email:""},systemDisabledState:o(),email:"",username:"",password:"",passwordConfirmed:"",lockPassword:"",lockPasswordConfirmed:"",routePaths:{login:i.ROUTE_PATH_LOGIN},violations:{email:[],username:[],password:[],passwordConfirmed:[],lockPassword:[],lockPasswordConfirmed:[]}}),validations(){return{form:{email:{required:k.withMessage(this.msgRequiredField,y),email:$},username:{required:k.withMessage(this.msgRequiredField,y)},password:{required:k.withMessage(this.msgRequiredField,y)},passwordConfirmed:{required:k.withMessage(this.msgRequiredField,y)},lockPassword:{required:k.withMessage(this.msgRequiredField,y)},lockPasswordConfirmed:{required:k.withMessage(this.msgRequiredField,y)}}}},mixins:[{name:"BaseApiResponseViolationsToDataFieldsViolations",methods:{responseViolationsToFieldViolations(e){let o=Object.values(e.invalidFields);for(let i of o){if(0===i.length)continue;let o=Object.keys(i);for(let a of o){let o=i[a];void 0===this.violations[a]&&(this.violations[a]=[]);let t=this.violations[a];t||s.error("Field is missing in `data.violations`",{"data.violations":this.violations,"response.invalidFields":e.invalidFields}),t.push(o)}}}}},b,x,v],methods:{onConfirmPasswordChanged(s){this.form.passwordConfirmed=s},onPasswordChanged(s){this.form.password=s},bothPasswordsChanged(s){this.form.password=s,this.form.passwordConfirmed=s},onConfirmLockPasswordChanged(s){this.form.lockPasswordConfirmed=s},onLockPasswordChanged(s){this.form.lockPassword=s},onBothLockPasswordsChanged(s){this.form.lockPassword=s,this.form.lockPasswordConfirmed=s},onRegisterSubmit(){this.systemDisabledState.isDisabled||(this.validateForm()?(this.$rootEvent.showFullPageLoader(),this.$axios.post(t.buildUrl(r.URL_REGISTER_USER),this.form).then((s=>{if(this.responseViolationsToFieldViolations(s),!s.success)return this.handleResponse(s,r.URL_REGISTER_USER),void this.$rootEvent.hideFullPageLoader();this.$rootEvent.showNotification(a.info,this.$t("security.register.texts.msg.success")),setTimeout((()=>{this.$rootEvent.hideFullPageLoader(),this.$router.push(i.ROUTE_PATH_LOGIN)}),3e3)}))):this.$rootEvent.showNotification(a.warning,this.$t("validation.other.genericInvalidFields")))},validateForm(){this.v$.$validate();let s=this.$refs.passwordWithConfirmation.validateInput(),e=this.$refs.lockPasswordWithConfirmation.validateInput();return this.violations=this.vuelidateErrorsToPropsViolation(this.v$.$errors),s&&e&&this.isVuelidateResultValid}},components:{"password-with-confirmation":C,"asterisk-required":l,"vue-input":d,MediumButtonWithIcon:n}},[["render",function(s,e,o,i,a,t){const r=m("vue-input"),l=m("password-with-confirmation"),d=m("asterisk-required"),n=m("MediumButtonWithIcon"),b=m("router-link");return u(),h("div",null,[f("div",R,[f("div",F,[f("div",q,[f("div",V,c(s.$t("security.register.header.label")),1)]),f("div",_,[f("div",D,[f("div",E,[f("div",L,[w(r,{type:"email",label:s.$t("security.register.form.email.label"),"is-required":!0,errors:a.violations.email,"is-disabled":a.systemDisabledState.isDisabled,modelValue:a.form.email,"onUpdate:modelValue":e[0]||(e[0]=s=>a.form.email=s)},null,8,["label","errors","is-disabled","modelValue"]),w(r,{type:"text",label:s.$t("security.register.form.username.label"),"is-required":!0,errors:a.violations.username,"is-disabled":a.systemDisabledState.isDisabled,modelValue:a.form.username,"onUpdate:modelValue":e[1]||(e[1]=s=>a.form.username=s)},null,8,["label","errors","is-disabled","modelValue"])]),w(l,{onConfirmPasswordChanged:t.onConfirmPasswordChanged,onPasswordChanged:t.onPasswordChanged,onBothPasswordsChanged:t.bothPasswordsChanged,ref:"passwordWithConfirmation",class:"mb-6",disabled:a.systemDisabledState.isDisabled},null,8,["onConfirmPasswordChanged","onPasswordChanged","onBothPasswordsChanged","disabled"]),w(l,{onConfirmPasswordChanged:t.onConfirmLockPasswordChanged,onPasswordChanged:t.onLockPasswordChanged,onBothPasswordsChanged:t.onBothLockPasswordsChanged,ref:"lockPasswordWithConfirmation",class:"mb-6",disabled:a.systemDisabledState.isDisabled,"password-label":s.$t("security.register.form.lockPassword.text"),"confirm-password-label":s.$t("security.register.form.confirmLockPassword.label")},null,8,["onConfirmPasswordChanged","onPasswordChanged","onBothPasswordsChanged","disabled","password-label","confirm-password-label"])]),f("p",null,[g(c(s.$t("generic.asteriskFieldsAreRequired"))+" ",1),w(d)]),f("div",S,[w(n,{onClick:e[2]||(e[2]=s=>t.onRegisterSubmit()),"top-wrapper-classes":"w-full sm:w-auto","button-classes":"w-full sm:w-auto","text-classes":"text-center w-full",text:s.$t("security.register.form.submit.label"),disabled:a.systemDisabledState.isDisabled},null,8,["text","disabled"])])])]),f("div",T,[f("span",I,c(s.$t("security.register.texts.links.alreadyGotAnAccount.label")),1),f("span",null,[w(b,{to:a.routePaths.login,class:"link"},{default:p((()=>[g(c(s.$t("security.register.texts.links.alreadyGotAnAccount.linkText")),1)])),_:1},8,["to"])])])])])])}],["__scopeId","data-v-2c014183"]]);export{M as default};
