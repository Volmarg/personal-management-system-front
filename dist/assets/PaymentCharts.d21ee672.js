import{_ as t,r as a,o as e,e as r,f as l,t as s,h as o,g as i,ab as n,a_ as h,Y as c,k as d}from"./index.fd0df9df.js";import{B as p}from"./Base.b0f5291c.js";import{Y as u}from"./YearSelect.17ba7bfb.js";import{_ as b,A as m,c as f}from"./ChartJsMixin.016e35bb.js";import{S as y}from"./SymfonyReportsRoutes.7a4f2601.js";import"./BrowserDetection.6a5570eb.js";import"./ColorBorderBar.5f37d705.js";const g={class:"text-2xl mb-1"},x={key:0,class:"flex flex-col justify-end"},C={class:"text-lg text-center md:text-right pr-0 md:pr-6 mb-1"},w={class:"w-full flex justify-end"},v={class:"w-full md:w-1/2 lg:w-1/3 xl:w-1/6 md:mr-2"},Y={class:"chart-wrapper lg:p-10 xl:p-20 flex justify-end flex-col"},B={ref:"chartWrapper",height:"100%",style:{"max-height":"400px"}};var $=t({data:()=>({yearFilter:null,allYears:[],chartData:{}}),mixins:[b],components:{Actions:m,YearSelect:u},computed:{datasets(){let t=[];for(let a in this.chartData){let e=this.chartData[a],r={fill:!1,label:a,data:this.getDatasetValues(e)};t.push(r)}return t},labels(){let t=[];for(let e in this.chartData){let a=this.chartData[e];t=[...t,...a.map((t=>t.label))]}if(!this.yearFilter)return[...new Set(t)];let a=[];for(let e of t)e.match(/[0-9]{4}/)[0]==this.yearFilter&&a.push(e);return[...new Set(a)]},chartConfig(){let t="rgba(5, 150, 105, 0.3)";return{type:"line",data:{labels:this.labels,datasets:this.datasets},options:{scales:{x:{title:{display:!0,text:this.$t("reports.saving.eachMonth.chart.scale.x.label"),font:{weight:"bold"}}},y:{title:{display:!0,text:this.$t("reports.saving.eachMonth.chart.scale.y.label"),font:{weight:"bold"}}}},responsive:!0,maintainAspectRatio:!1,plugins:{autocolors:{offset:24,customize(t){const a=(t,a)=>f(t).lighten(a).rgbString();return{background:a(t.colors.background,.25),border:a(t.colors.border,.25)}},mode:"data"},crosshair:{sync:{enabled:!1},line:{color:t,width:1},zoom:{enabled:!0,zoomboxBackgroundColor:t,zoomboxBorderColor:t,zoomButtonClass:"chart-reset-zoom",zoomButtonText:this.$t("generic.chart.resetButton.label")}},datalabels:{backgroundColor:function(){return"rgba(59, 130, 246, 0.6)"},borderRadius:4,color:"white",font:{weight:"bold"},formatter:Math.round,padding:4},title:{display:!1},tooltip:{mode:"index",animation:!1,intersect:!1,displayColors:!1,callbacks:{label:function(t){return t.chart.data.datasets[t.datasetIndex].label+": "+t.raw}}},legend:{position:"bottom"}}}}}},methods:{getDatasetValues(t){if(!this.yearFilter)return t.map((t=>t.value));let a=[];for(let e of t)e.label.match(/[0-9]{4}/)[0]==this.yearFilter&&a.push(e.value);return a},applyYearFilter(t){this.yearFilter=t,this.refreshChart(this.chartConfig,this.$refs.chartWrapper)},buildYears(){for(let t of this.labels)this.allYears.push(t.match(/[0-9]{4}/)[0]);this.allYears=[...new Set(this.allYears)]}},async mounted(){this.chartData=await this.$moduleCall.getAll(y.PAYMENTS_TOTAL_PER_MONTH_BASE_URL),this.buildYears(),this.createChart(this.chartConfig,this.$refs.chartWrapper)}},[["render",function(t,h,c,d,p,u){const b=a("YearSelect"),m=a("Actions");return e(),r(n,null,[l("div",null,[l("h2",g,s(t.$t("reports.paymentCharts.tabs.totalEachMonth.header")),1),this.allYears.length>0?(e(),r("div",x,[l("div",null,[l("h2",C,s(t.$t("reports.paymentCharts.tabs.totalEachMonth.filter.filterByYear.header")),1)]),l("div",w,[l("div",v,[o(b,{years:p.allYears,"allow-all-option":!0,"onUpdate:modelValue":h[0]||(h[0]=t=>u.applyYearFilter(t))},null,8,["years"])])])])):i("",!0)]),l("div",Y,[o(m,{"chart-instance":t.chartInstance},null,8,["chart-instance"]),l("canvas",B,null,512)])],64)}]]);const D={class:"text-2xl mb-1"},T={key:0,class:"flex flex-col justify-end"},S={class:"text-lg text-center md:text-right pr-0 md:pr-6 mb-1"},A={class:"w-full flex justify-end"},_={class:"w-full md:w-1/2 lg:w-1/3 xl:w-1/6 md:mr-2"},k={class:"chart-wrapper lg:p-10 xl:p-20 flex justify-end flex-col"},F={ref:"chartWrapper",height:"100%",style:{"max-height":"400px"}};var E=t({data:()=>({yearFilter:null,allYears:[],chartData:{}}),mixins:[b],components:{Actions:m,YearSelect:u},computed:{datasets(){let t=[];for(let a in this.chartData){let e=this.chartData[a],r={fill:!1,label:a,data:this.getDatasetValues(e)};t.push(r)}return t},labels(){let t=[];for(let e in this.chartData){let a=this.chartData[e];t=[...t,...a.map((t=>t.label))]}if(!this.yearFilter)return[...new Set(t)];let a=[];for(let e of t)e.match(/[0-9]{4}/)[0]==this.yearFilter&&a.push(e);return[...new Set(a)]},chartConfig(){let t="rgba(5, 150, 105, 0.3)";return{type:"line",data:{labels:this.labels,datasets:this.datasets},options:{scales:{x:{title:{display:!0,text:this.$t("reports.saving.eachMonth.chart.scale.x.label"),font:{weight:"bold"}}},y:{grace:"10%",min:0,title:{display:!0,text:this.$t("reports.saving.eachMonth.chart.scale.y.label"),font:{weight:"bold"}}}},responsive:!0,maintainAspectRatio:!1,plugins:{autocolors:{offset:24,customize(t){const a=(t,a)=>f(t).lighten(a).rgbString();return{background:a(t.colors.background,.25),border:a(t.colors.border,.25)}},mode:"data"},crosshair:{sync:{enabled:!1},line:{color:t,width:1},zoom:{enabled:!0,zoomboxBackgroundColor:t,zoomboxBorderColor:t,zoomButtonClass:"chart-reset-zoom",zoomButtonText:this.$t("generic.chart.resetButton.label")}},title:{display:!1},tooltip:{mode:"index",animation:!1,intersect:!1,displayColors:!1,callbacks:{label:function(t){return t.chart.data.datasets[t.datasetIndex].label+": "+t.raw}}},legend:{position:"bottom"},datalabels:{display:!1}}}}}},methods:{getDatasetValues(t){if(!this.yearFilter)return t.map((t=>t.value));let a=[];for(let e of t)e.label.match(/[0-9]{4}/)[0]==this.yearFilter&&a.push(e.value);return a},applyYearFilter(t){this.yearFilter=t,this.refreshChart(this.chartConfig,this.$refs.chartWrapper)},buildYears(){for(let t of this.labels)this.allYears.push(t.match(/[0-9]{4}/)[0]);this.allYears=[...new Set(this.allYears)]}},async mounted(){this.chartData=await this.$moduleCall.getAll(y.PAYMENTS_TOTAL_PER_TYPE_BASE_URL),this.buildYears(),this.createChart(this.chartConfig,this.$refs.chartWrapper)}},[["render",function(t,h,c,d,p,u){const b=a("YearSelect"),m=a("Actions");return e(),r(n,null,[l("div",null,[l("h2",D,s(t.$t("reports.paymentCharts.tabs.byTypeEachMonth.header")),1),this.allYears.length>0?(e(),r("div",T,[l("div",null,[l("h2",S,s(t.$t("reports.paymentCharts.tabs.byTypeEachMonth.filter.filterByYear.header")),1)]),l("div",A,[l("div",_,[o(b,{years:p.allYears,"allow-all-option":!0,"onUpdate:modelValue":h[0]||(h[0]=t=>u.applyYearFilter(t))},null,8,["years"])])])])):i("",!0)]),l("div",k,[o(m,{"chart-instance":t.chartInstance},null,8,["chart-instance"]),l("canvas",F,null,512)])],64)}]]);const M={class:"text-2xl mb-1"},z={class:"chart-wrapper lg:p-10 xl:p-20 flex justify-end flex-col"},j={ref:"chartWrapper",height:"100%",style:{"max-height":"400px"}};var R=t({data:()=>({yearFilter:null,allYears:[],chartData:[]}),mixins:[b],computed:{labels(){return this.chartData.map((t=>t.label))},values(){return this.chartData.map((t=>t.value))},chartConfig(){return{type:"pie",data:{labels:this.labels,datasets:[{borderColor:"rgba(0,0,0,0.34)",data:this.values}]},options:{scales:{x:{type:"linear",display:!1},y:{type:"linear",display:!1}},responsive:!0,maintainAspectRatio:!1,plugins:{autocolors:{offset:14,customize(t){const a=(t,a)=>f(t).lighten(a).rgbString();return{background:a(t.colors.background,.25),border:a(t.colors.border,.25)}},mode:"data"},legend:{position:"right"},datalabels:{backgroundColor:function(t){return t.dataset.borderColor},borderRadius:4,color:"white",font:{weight:"bold"},formatter:function(t,a){return`${a.dataset.data[a.dataIndex]}%`},padding:4},tooltip:{animation:!1,intersect:!1,callbacks:{label:function(t){return t.raw+"%"}}}}}}}},methods:{async buildChartData(){let t=await this.$moduleCall.getAll(y.PAYMENTS_TOTAL_PER_TYPE_BASE_URL),a=[],e=0;for(let r in t)a[r]||(a[r]=0),t[r].map((t=>a[r]+=t.value)),e+=a[r];for(let r in a)this.chartData.push({value:(a[r]/e*100).toFixed(2),label:r})}},async mounted(){await this.buildChartData(),this.createChart(this.chartConfig,this.$refs.chartWrapper)}},[["render",function(t,a,o,i,n,h){return e(),r("div",null,[l("h2",M,s(t.$t("reports.paymentCharts.tabs.percentageByType.header")),1),l("div",z,[l("canvas",j,null,512)])])}]]),P=t({components:{Base:p,Tabs:h},methods:{buildTabsContent(){return[{tabName:this.$t("reports.paymentCharts.tabs.totalEachMonth.label"),tabComponent:$,tabComponentProps:{}},{tabName:this.$t("reports.paymentCharts.tabs.byTypeEachMonth.label"),tabComponent:E,tabComponentProps:{}},{tabName:this.$t("reports.paymentCharts.tabs.percentageByType.label"),tabComponent:R,tabComponentProps:{}}]}}},[["render",function(t,r,l,s,i,n){const h=a("Tabs"),p=a("Base");return e(),c(p,{"info-block-description":t.$t("contacts.settings.description")},{default:d((()=>[o(h,{"tabs-with-content":n.buildTabsContent()},null,8,["tabs-with-content"])])),_:1},8,["info-block-description"])}]]);export{P as default};
