import{_ as e,M as a,I as t,aW as l,B as s,r as o,o as r,e as n,f as i,t as d,h as u,aS as m,g as p,Y as h,aa as y,aE as b,aF as f,a_ as c,aI as S,aY as C,k as v}from"./index.7d9fe974.js";import{Y as P}from"./YearSelect.1cd24df8.js";import{P as j}from"./PoolsState.044541a4.js";import{S as w}from"./SymfonyJobRoutes.5142e112.js";import{B as x}from"./Base.ab092e87.js";import{S as Y}from"./SimpleTable.b7ae8abd.js";import{T as g}from"./TableActions.6c3f4113.js";import"./BrowserDetection.6a5570eb.js";import"./ColorBorderBar.336f836a.js";import"./SearchInput.85a30b8f.js";import"./ClipboardService.91f50b7a.js";const T={class:"flex justify-center"},F={class:"mt-6 md:w-1/2 lg:w-1/3 w-full flex flex-col"},V={class:"text-lg mb-2"};var $=e({data:()=>({poolsStore:null,form:{daysSpent:null,information:null,year:null}}),props:{header:{type:String,required:!1,default:""},id:{type:[Number,null],required:!1,default:null},year:{type:[Number,null],required:!1,default:null},daysSpent:{type:[String,null],required:!1,default:null},information:{type:[String,null],required:!1,default:null}},components:{YearSelect:P,MediumButtonWithIcon:a,FormInput:t},computed:{years(){return this.poolsStore.allEntries.map((e=>e.year))}},methods:{clearForm(){this.form.daysSpent=null,this.form.information=null,this.form.year=null},async onSubmit(){let e,a=new l(w.HOLIDAYS_SPENT_BASE_URL,this.id,s,this.form);a.reload=!1,e=this.id?await this.$moduleCall.update(a):await this.$moduleCall.new(a),e.success&&(this.$emit("submit"),this.clearForm())}},async beforeMount(){this.form.daysSpent=this.daysSpent,this.form.information=this.information,this.form.year=this.year,this.poolsStore=j(),await this.poolsStore.getAll()}},[["render",function(e,a,t,l,s,m){const p=o("YearSelect"),h=o("FormInput"),y=o("MediumButtonWithIcon");return r(),n("div",T,[i("div",F,[i("h2",V,d(t.header),1),u(p,{modelValue:s.form.year,"onUpdate:modelValue":a[0]||(a[0]=e=>s.form.year=e),years:m.years,class:"mb-6"},null,8,["modelValue","years"]),u(h,{type:"text",modelValue:s.form.information,"onUpdate:modelValue":a[1]||(a[1]=e=>s.form.information=e),"is-required":!0,label:e.$t("job.holidays.shared.form.information.label")},null,8,["modelValue","label"]),u(h,{type:"number",modelValue:s.form.daysSpent,"onUpdate:modelValue":a[2]||(a[2]=e=>s.form.daysSpent=e),"is-required":!0,label:e.$t("job.holidays.shared.form.daysSpent.label")},null,8,["modelValue","label"]),u(y,{text:e.$t("job.holidays.shared.form.submit.label"),"button-extra-classes":"pt-3 pb-3 sm:pt-1 sm:pb-1",class:"w-full mb-1 md:col-start-1 md:col-end-2 mt-6","button-classes":"w-full md:w-auto m-0-force","text-classes":"text-center w-full",onButtonClick:m.onSubmit},null,8,["text","onButtonClick"])])])}]]);const A={key:0,class:"flex flex-col justify-end"},I={class:"text-lg text-center md:text-right pr-0 md:pr-6 mb-1"},D={class:"w-full flex justify-end"},E={class:"w-full md:w-1/2 lg:w-1/3 xl:w-1/6 md:mr-2"};var k=e({data(){return{yearFilter:null,headers:[{label:"id",dataValuePath:"id.value",isVisible:!1,dataIsComponentPath:null,dataComponentPropertiesPath:null},{label:this.$t("job.holidays.tabs.spent.table.headers.year.label"),dataValuePath:"year.value",dataIsComponentPath:"year.isComponent",dataComponentPropertiesPath:null},{label:this.$t("job.holidays.tabs.spent.table.headers.daysSpent.label"),dataValuePath:"daysSpent.value",dataIsComponentPath:"daysSpent.isComponent",dataComponentPropertiesPath:null},{label:this.$t("job.holidays.tabs.spent.table.headers.information.label"),dataValuePath:"information.value",dataIsComponentPath:"information.isComponent",dataComponentPropertiesPath:null},{label:this.$t("job.holidays.tabs.spent.table.headers.actions.label"),dataValuePath:"actions.value",dataIsComponentPath:"actions.isComponent",dataComponentPropertiesPath:"actions.componentProps"}]}},props:{data:{type:Array,required:!0}},components:{YearSelect:P,NoResultsText:m,SimpleTable:Y},computed:{usedData(){let e=[];for(let a of this.data)this.yearFilter&&a.values.year.value!=this.yearFilter||e.push(a);return e},allYears(){let e=[];if(0!==this.data.length){for(let a of this.data){let t=a.values.year.value.match(/[0-9]*/);t&&e.push(t[0])}return[...new Set(e)]}}},watch:{yearFilter(){this.$refs.table.refresh()}}},[["render",function(e,a,t,l,s,m){const b=o("YearSelect"),f=o("SimpleTable"),c=o("NoResultsText");return r(),n(y,null,[m.allYears.length>0?(r(),n("div",A,[i("div",null,[i("h2",I,d(e.$t("job.holidays.shared.filter.byYear.header")),1)]),i("div",D,[i("div",E,[u(b,{years:m.allYears,"allow-all-option":!0,modelValue:s.yearFilter,"onUpdate:modelValue":a[0]||(a[0]=e=>s.yearFilter=e)},null,8,["years","modelValue"])])])])):p("",!0),t.data.length>0?(r(),h(f,{key:1,headers:s.headers,data:m.usedData,ref:"table",class:"mt-4"},null,8,["headers","data"])):(r(),h(c,{key:2}))],64)}]]);const B=b("jobHolidaysDaysSpentState",{state:()=>({allEntries:[]}),actions:{async getAll(){this.allEntries=await(new f).getAll(w.HOLIDAYS_SPENT_BASE_URL)}}});var N=e({props:{holidays:{type:Array,require:!0}},components:{HolidaysSpentTable:k,NoResultsText:m},computed:{usedTableData(){let e=[];for(let a of this.holidays)e.push({values:{id:{value:a.id,isComponent:!1},year:{value:String(a.year),isComponent:!1},daysSpent:{value:a.daysSpent,isComponent:!1},information:{value:a.information,isComponent:!1},actions:{value:g,isComponent:!0,componentProps:{editActionForm:$,baseUrl:w.HOLIDAYS_SPENT_BASE_URL,store:[B,j]}}}});return e}}},[["render",function(e,a,t,l,s,n){const i=o("HolidaysSpentTable"),d=o("NoResultsText");return n.usedTableData.length>0?(r(),h(i,{key:0,data:n.usedTableData},null,8,["data"])):(r(),h(d,{key:1}))}]]);const _={key:0,class:"flex flex-col justify-end"},q={class:"text-lg text-center md:text-right pr-0 md:pr-6 mb-1"},R={class:"w-full flex justify-end"},L={class:"w-full md:w-1/2 lg:w-1/3 xl:w-1/6 md:mr-2"};var U=e({data:()=>({poolsStore:null,daysSpentStore:null}),components:{HolidaysSummaryTable:e({data(){return{allYears:[],yearFilter:null,headers:[{label:this.$t("job.holidays.tabs.summary.table.headers.year.label"),dataValuePath:"year.value",dataIsComponentPath:"year.isComponent",dataComponentPropertiesPath:null},{label:this.$t("job.holidays.tabs.summary.table.headers.daysForYear.label"),dataValuePath:"daysForYear.value",dataIsComponentPath:"daysForYear.isComponent",dataComponentPropertiesPath:null},{label:this.$t("job.holidays.tabs.summary.table.headers.daysSpent.label"),dataValuePath:"daysSpent.value",dataIsComponentPath:"daysSpent.isComponent",dataComponentPropertiesPath:null},{label:this.$t("job.holidays.tabs.summary.table.headers.daysLeft.label"),dataValuePath:"daysLeft.value",dataIsComponentPath:"daysLeft.isComponent",dataComponentPropertiesPath:null}]}},props:{data:{type:Array,required:!0}},components:{YearSelect:P,NoResultsText:m,SimpleTable:Y},computed:{usedData(){let e=[];for(let a of this.data)this.yearFilter&&a.values.year.value!=this.yearFilter||e.push(a);return e}},methods:{buildYears(){if(0!==this.data.length){for(let e of this.data){let a=e.values.year.value.match(/[0-9]*/);a&&this.allYears.push(a[0])}this.allYears=[...new Set(this.allYears)]}}},mounted(){this.buildYears()},watch:{yearFilter(){this.$refs.table.refresh()}}},[["render",function(e,a,t,l,s,m){const b=o("YearSelect"),f=o("SimpleTable"),c=o("NoResultsText");return r(),n(y,null,[s.allYears.length>0?(r(),n("div",_,[i("div",null,[i("h2",q,d(e.$t("job.holidays.shared.filter.byYear.header")),1)]),i("div",R,[i("div",L,[u(b,{years:s.allYears,modelValue:s.yearFilter,"onUpdate:modelValue":a[0]||(a[0]=e=>s.yearFilter=e)},null,8,["years","modelValue"])])])])):p("",!0),t.data.length>0?(r(),h(f,{key:1,headers:s.headers,data:m.usedData,ref:"table",class:"mt-4"},null,8,["headers","data"])):(r(),h(c,{key:2}))],64)}]]),NoResultsText:m},props:{pools:{type:Array,require:!0},holidays:{type:Array,require:!0}},computed:{usedTableData(){var e,a;let t=[],l=[];for(let s of this.holidays)l[s.year]||(l[s.year]=0),l[s.year]+=s.daysSpent;for(let s in l){let o=l[s],r=null!=(a=null==(e=this.pools.find((e=>e.year==s)))?void 0:e.days)?a:null;t.push({values:{year:{value:s,isComponent:!1},daysForYear:{value:null!=r?r:"???",isComponent:!1},daysSpent:{value:o,isComponent:!1},daysLeft:{value:r?r-o:"???",isComponent:!1}}})}for(let s of this.pools)Object.keys(l).includes(s.year)||t.push({values:{year:{value:s.year,isComponent:!1},daysForYear:{value:s.days,isComponent:!1},daysSpent:{value:0,isComponent:!1},daysLeft:{value:s.days,isComponent:!1}}});return c.sortObjects(t,"values.year.value")}}},[["render",function(e,a,t,l,s,n){const i=o("HolidaysSummaryTable"),d=o("NoResultsText");return n.usedTableData.length>0?(r(),h(i,{key:0,data:n.usedTableData},null,8,["data"])):(r(),h(d,{key:1}))}]]),H=e({data:()=>({poolsStore:null,daysSpentStore:null,pools:[],holidays:[],form:{daysSpent:null,information:null,year:null}}),components:{AddEditForm:$,Container:S,Base:x,Tabs:C},computed:{tabsContent(){return[{tabName:this.$t("job.holidays.tabs.summary.label"),tabComponent:U,tabComponentProps:{pools:this.pools,holidays:this.holidays}},{tabName:this.$t("job.holidays.tabs.spent.label"),tabComponent:N,tabComponentProps:{holidays:this.holidays}}]}},methods:{async getData(){await Promise.allSettled([this.poolsStore.getAll(),this.daysSpentStore.getAll()]),this.pools=this.poolsStore.allEntries,this.holidays=this.daysSpentStore.allEntries}},beforeMount(){this.poolsStore=j(),this.daysSpentStore=B(),this.getData()},watch:{"poolsStore.allEntries":{deep:!0,handler:function(){this.pools=this.poolsStore.allEntries}},"daysSpentStore.allEntries":{deep:!0,handler:function(){this.holidays=this.daysSpentStore.allEntries}}}},[["render",function(e,a,t,l,s,n){const i=o("Tabs"),d=o("Container"),m=o("AddEditForm"),p=o("Base");return r(),h(p,{"info-block-description":e.$t("job.holidays.description"),"is-in-container":!1},{default:v((()=>[u(d,null,{default:v((()=>[u(i,{"tabs-with-content":n.tabsContent},null,8,["tabs-with-content"])])),_:1}),u(d,{class:"mt-4"},{default:v((()=>[u(m,{header:e.$t("job.holidays.shared.form.header"),onSubmit:n.getData},null,8,["header","onSubmit"])])),_:1})])),_:1},8,["info-block-description"])}]]);export{H as default};
