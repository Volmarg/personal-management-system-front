import{B as e}from"./Base.b55dfd74.js";import{_ as t,aS as a,r as n,o,Y as l,e as r,f as s,t as i,aa as u,af as m,g as d,aV as c,M as p,I as y,aW as h,B as b,h as f,aE as w,aF as C,aI as g,aY as v,k as P}from"./index.db8bde11.js";import{S as O}from"./SimpleTable.f571356e.js";import{C as B}from"./CurrencySelect.0c9cc198.js";import{S as V}from"./SymfonyPaymentsRoutes.6d013679.js";import{T as M}from"./TableActions.744b2f39.js";import"./BrowserDetection.6a5570eb.js";import"./ColorBorderBar.86dcbce2.js";import"./SearchInput.ef99a9ef.js";import"./FinancesCurrenciesState.1b426610.js";import"./ClipboardService.e68b9e1f.js";var S=t({components:{Table:t({data(){return{allYears:[],yearFilter:null,headers:[{label:"id",dataValuePath:"id.value",isVisible:!1,dataIsComponentPath:null,dataComponentPropertiesPath:null},{label:"owedByMe",dataValuePath:"owedByMe.rawValue",isVisible:!1,dataIsComponentPath:null,dataComponentPropertiesPath:null},{label:this.$t("payments.moneyOwed.table.header.target.label"),dataValuePath:"target.value",dataIsComponentPath:"target.isComponent",dataComponentPropertiesPath:null},{label:this.$t("payments.moneyOwed.table.header.amount.label"),dataValuePath:"amount.value",dataIsComponentPath:"amount.isComponent",dataComponentPropertiesPath:null},{label:this.$t("payments.moneyOwed.table.header.information.label"),dataValuePath:"information.value",dataIsComponentPath:"information.isComponent",dataComponentPropertiesPath:null},{label:this.$t("payments.moneyOwed.table.header.date.label"),dataValuePath:"date.value",dataIsComponentPath:"date.isComponent",dataComponentPropertiesPath:null},{label:this.$t("payments.moneyOwed.table.header.currency.label"),dataValuePath:"currency.value",dataIsComponentPath:"currency.isComponent",dataComponentPropertiesPath:null},{label:this.$t("payments.moneyOwed.table.header.actions.label"),dataValuePath:"actions.value",dataIsComponentPath:"actions.isComponent",dataComponentPropertiesPath:"actions.componentProps"}]}},props:{data:{type:Array,required:!0}},components:{NoResultsText:a,SimpleTable:O}},[["render",function(e,t,a,r,s,i){const u=n("SimpleTable"),m=n("NoResultsText");return a.data.length>0?(o(),l(u,{key:0,headers:s.headers,data:a.data,ref:"table",class:"mt-4"},null,8,["headers","data"])):(o(),l(m,{key:1}))}]])},props:{data:{type:Array,required:!0}}},[["render",function(e,t,a,r,s,i){const u=n("Table");return o(),l(u,{data:a.data},null,8,["data"])}],["__scopeId","data-v-4c77ab66"]]);const x={key:0,class:"single-section"},$={class:"section-header"},k=["innerHTML"],E={key:1,class:"single-section"},F={class:"section-header"},I=["innerHTML"];var _=t({props:{data:{type:Array,required:!0}},methods:{getOwedEntries(e){let t={};for(let a of this.data)if(a.values.owedByMe.rawValue===e){let e=a.values.target.value+a.values.currency.value;Object.keys(t).includes(e)||(t[e]={amount:0,target:a.values.target.value,currency:a.values.currency.value}),t[e].amount+=a.values.amount.value}return 0===Object.keys(t).length?null:t}}},[["render",function(e,t,a,n,l,c){return o(),r(u,null,[(e.entries=c.getOwedEntries(!0))?(o(),r("div",x,[s("p",$,i(e.$t("payments.moneyOwed.tabs.summary.text.owedByMe")),1),s("ul",null,[(o(!0),r(u,null,m(e.entries,(t=>(o(),r("li",{class:"one-entry",key:JSON.stringify(t),innerHTML:e.$t("payments.moneyOwed.tabs.summary.text.i-owe-to",{target:t.target,amount:t.amount,currency:t.currency})},null,8,k)))),128))])])):d("",!0),(e.entries=c.getOwedEntries(!1))?(o(),r("div",E,[s("p",F,i(e.$t("payments.moneyOwed.tabs.summary.text.owedByOthers")),1),s("ul",null,[(o(!0),r(u,null,m(e.entries,(t=>(o(),r("li",{class:"one-entry",key:JSON.stringify(t),innerHTML:e.$t("payments.moneyOwed.tabs.summary.text.other-owe",{target:t.target,amount:t.amount,currency:t.currency})},null,8,I)))),128))])])):d("",!0)],64)}],["__scopeId","data-v-61876391"]]);const q={data:()=>({form:{target:null,information:null,date:null,amount:null,currency:null,owedByMe:!1}}),props:{header:{type:String,required:!1,default:""},id:{type:[Number,null],required:!1,default:null},target:{type:[String,null],required:!1,default:null},amount:{type:[Number,null],required:!1,default:null},information:{type:[String,null],required:!1,default:null},date:{type:[String,null],required:!1,default:null},currency:{type:[String,null],required:!1,default:null},owedByMe:{type:Boolean,required:!1,default:!1}},components:{CurrencySelect:B,Checkbox:c,MediumButtonWithIcon:p,FormInput:y},methods:{clearForm(){this.form.target=null,this.form.information=null,this.form.date=null,this.form.amount=null,this.form.currency=null,this.form.owedByMe=null},async onSubmit(){let e,t=new h(V.MONEY_OWED_BASE_URL,this.id,b,this.form);t.reload=!1,e=this.id?await this.$moduleCall.update(t):await this.$moduleCall.new(t),e.success&&(this.$emit("submit"),this.clearForm())}},beforeMount(){this.form.target=this.target,this.form.information=this.information,this.form.date=this.date,this.form.amount=this.amount,this.form.currency=this.currency,this.form.owedByMe=this.owedByMe}},T={class:"flex justify-center mt-10"},j={class:"mt-6 md:w-1/2 lg:w-1/3 w-full flex flex-col"},N={class:"text-lg"},A={class:"mt-4 mb-4 flex flex-row hover:opacity-70 cursor-pointer"};var D=t(q,[["render",function(e,t,a,l,u,m){const d=n("FormInput"),c=n("CurrencySelect"),p=n("Checkbox"),y=n("MediumButtonWithIcon");return o(),r("div",T,[s("div",j,[s("h2",N,i(a.header),1),f(d,{type:"text",modelValue:u.form.target,"onUpdate:modelValue":t[0]||(t[0]=e=>u.form.target=e),"is-required":!0,label:e.$t("payments.moneyOwed.newForm.target.label")},null,8,["modelValue","label"]),f(d,{type:"text",modelValue:u.form.information,"onUpdate:modelValue":t[1]||(t[1]=e=>u.form.information=e),"is-required":!0,label:e.$t("payments.moneyOwed.newForm.information.label")},null,8,["modelValue","label"]),f(d,{type:"date",modelValue:u.form.date,"onUpdate:modelValue":t[2]||(t[2]=e=>u.form.date=e),"is-required":!0,label:e.$t("payments.moneyOwed.newForm.date.label")},null,8,["modelValue","label"]),f(d,{type:"number",modelValue:u.form.amount,"onUpdate:modelValue":t[3]||(t[3]=e=>u.form.amount=e),"is-required":!0,label:e.$t("payments.moneyOwed.newForm.amount.label")},null,8,["modelValue","label"]),f(c,{modelValue:u.form.currency,"onUpdate:modelValue":t[4]||(t[4]=e=>u.form.currency=e)},null,8,["modelValue"]),s("div",A,[f(p,{class:"transform scale-75",modelValue:u.form.owedByMe,"onUpdate:modelValue":t[5]||(t[5]=e=>u.form.owedByMe=e),ref:"checkbox"},null,8,["modelValue"]),s("label",{class:"checkbox checkbox-all align-self-center ml-1 cursor-pointer",onClick:t[6]||(t[6]=e=>this.$refs.checkbox.toggle())},i(e.$t("payments.moneyOwed.newForm.owedByMe.label")),1)]),f(y,{text:e.$t("payments.productPrices.newForm.submit.label"),"button-extra-classes":"pt-3 pb-3 sm:pt-1 sm:pb-1",class:"w-full mb-1 md:col-start-1 md:col-end-2 mt-6","button-classes":"w-full md:w-auto m-0-force","text-classes":"text-center w-full",onButtonClick:m.onSubmit},null,8,["text","onButtonClick"])])])}]]);const U=w("paymentMoneyOwedState",{state:()=>({allEntries:[]}),actions:{async getAll(){this.allEntries=await(new C).getAll(V.MONEY_OWED_BASE_URL)}}});var L=t({data:()=>({store:null,owedData:[]}),components:{AddEditForm:D,Container:g,Tabs:v,Base:e},computed:{tableData(){let e=[];for(let t of this.owedData)e.push({values:{id:{value:t.id,isComponent:!1},target:{value:t.target,isComponent:!1},amount:{value:t.amount,isComponent:!1},information:{value:t.information,isComponent:!1},date:{value:t.date,isComponent:!1},owedByMe:{value:this.$t(`generic.bool.yesNo.${Number(t.owedByMe)}`),rawValue:t.owedByMe,isComponent:!1},currency:{value:t.currency,isComponent:!1},actions:{value:M,isComponent:!0,componentProps:{editActionForm:D,baseUrl:V.MONEY_OWED_BASE_URL,store:U}}}});return e},tabsContent(){return[{tabName:this.$t("payments.moneyOwed.tabs.byOthers.label"),tabComponent:S,tabComponentProps:{data:this.tableData.filter((e=>!e.values.owedByMe.rawValue))}},{tabName:this.$t("payments.moneyOwed.tabs.byMe.label"),tabComponent:S,tabComponentProps:{data:this.tableData.filter((e=>e.values.owedByMe.rawValue))}},{tabName:this.$t("payments.moneyOwed.tabs.summary.label"),tabComponent:_,tabComponentProps:{data:this.tableData}}]}},methods:{async refreshPageState(){await this.store.getAll(),this.owedData=this.store.allEntries}},async beforeMount(){this.store=U(),this.refreshPageState()},watch:{"store.allEntries":{deep:!0,handler:function(){this.owedData=this.store.allEntries}}}},[["render",function(e,t,a,l,s,i){const m=n("Tabs"),d=n("Base"),c=n("AddEditForm"),p=n("Container");return o(),r(u,null,[f(d,{"info-block-description":e.$t("payments.moneyOwed.description"),"is-in-container":!1},{default:P((()=>[f(m,{"tabs-with-content":i.tabsContent},null,8,["tabs-with-content"])])),_:1},8,["info-block-description"]),f(p,null,{default:P((()=>[f(c,{header:e.$t("payments.moneyOwed.newForm.header"),onSubmit:i.refreshPageState},null,8,["header","onSubmit"])])),_:1})],64)}]]);export{L as default};
