import{_ as e,I as i,r as s,o as t,e as a,h as o,Q as l,ab as r,a0 as n,M as d,S as u,T as m,$ as c,Y as h,k as b,c as g,U as p,a9 as v}from"./index.db8bde11.js";import{S as f,R as D,_ as V}from"./ResponsiveViewNavMixin.c9bc78b7.js";import{u as A,c as E,r as $,e as w,_ as I}from"./index.esm.96234115.js";import{_ as S}from"./DemoAwareMixin.2a25d48f.js";import{U as M}from"./UploadDialog.bfc03424.js";import{B as U}from"./BrowserDetection.6a5570eb.js";import"./ColorBorderBar.86dcbce2.js";import"./SymfonyFileRoutes.5d7880cf.js";import"./StorageState.8952430d.js";var x=e({data:()=>({isMobileBrowser:U.isMobileBrowser(),isDetailModalVisible:!1,isProfileImageModalVisible:!1,isEmailAddressDialogVisible:!1,isEditPersonalDataDialogVisible:!1}),components:{EmailAddressDialog:e({setup:()=>({v$:A()}),data:()=>({userStore:null,emailAddress:"",violations:{emailAddress:[]}}),validations(){return{emailAddress:{required:E.withMessage(this.$t("validations.required"),$),email:w}}},props:{isVisible:{type:Boolean,required:!1}},emits:["fileRemoved"],mixins:[I,l,S],components:{la:r,Modal:n,EmailAddressInput:e({data:()=>({emailAddress:null}),emits:["update:modelValue"],components:{Vinput:i},props:{violations:{type:Array,required:!0},modelValue:{required:!1}},created(){this.emailAddress=this.modelValue},watch:{modelValue(){this.emailAddress=this.modelValue}}},[["render",function(e,i,l,r,n,d){const u=s("Vinput");return t(),a("div",null,[o(u,{label:e.$t("userSettings.tab.baseData.children.emailAddress.form.emailAddress.label"),type:"text",onInput:i[0]||(i[0]=i=>e.$emit("update:modelValue",i.target.value)),"is-required":!0,errors:l.violations,modelValue:n.emailAddress,"onUpdate:modelValue":i[1]||(i[1]=e=>n.emailAddress=e)},null,8,["label","errors","modelValue"])])}]]),MediumButtonWithIcon:d},computed:{dialogSize(){return this.isPhoneBreakingPoint?"full":"medium"}},methods:{save(){if(this.isDemo||!this.validateForm())return;let e=u.buildUrl(f.URL_USER_BASE_DATA_EMAIL_SAVE,{[f.URL_USER_BASE_DATA_EMAIL_SAVE_PARAM_EMAIL]:encodeURIComponent(this.emailAddress)});this.$rootEvent.showFullPageLoader(),this.$axios.get(e).then((async e=>{if(this.$rootEvent.hideFullPageLoader(),e.isMessageSet()){let i=e.success?m.success:m.warning;this.$rootEvent.showNotification(i,e.message)}await this.userStore.refreshUserData(),this.emailAddress=this.userStore.user.email}))},validateForm(){return this.v$.$validate(),this.violations=this.vuelidateErrorsToPropsViolation(this.v$.$errors),0===Object.keys(this.violations).length}},created(){this.userStore=c(),this.emailAddress=this.userStore.user.email}},[["render",function(e,i,a,l,r,n){const d=s("MediumButtonWithIcon"),u=s("EmailAddressInput"),m=s("la"),c=s("Modal");return t(),h(c,{title:e.$t("userSettings.tab.baseData.children.emailAddress.dialog.header"),"is-visible":a.isVisible,size:n.dialogSize},{cancelButton:b((()=>[o(d,{text:e.$t("userSettings.tab.baseData.children.emailAddress.dialog.button.cancel.label"),"is-mobile-full-width":!0,"margin-right-class":"mr-0",class:"px-2 sm:px-0",onClick:i[0]||(i[0]=i=>e.$emit("modalClosed"))},null,8,["text"])])),content:b((()=>[o(u,{modelValue:r.emailAddress,"onUpdate:modelValue":i[1]||(i[1]=e=>r.emailAddress=e),violations:r.violations.emailAddress},null,8,["modelValue","violations"]),o(d,{text:e.$t("userSettings.tab.baseData.children.emailAddress.form.submit.label"),"is-mobile-full-width":!0,disabled:e.isDemo,onButtonClick:n.save,class:"submit-button"},{icon:b((()=>[o(m,{"svg-icon-name":"save-solid","font-size":30,color:"white",class:"hover:opacity-50 cursor-pointer"})])),_:1},8,["text","disabled","onButtonClick"])])),_:1},8,["title","is-visible","size"])}]]),ProfileImageUpload:e({data:()=>({configurationId:"ef61b8bf828699f522861815c9ac8969"}),props:{isVisible:{type:Boolean,required:!1}},emits:["profileImageChanged"],components:{UploadDialog:M},methods:{onUploadFinished(e){if(!e.isSuccess)return void(g.isEmptyString(e.message)||this.$rootEvent.showNotification(m.warning,e.message));let i=u.buildUrl(f.URL_CHANGE_PROFILE_IMAGE);this.$rootEvent.showFullPageLoader(),this.$axios.get(i).then((e=>{if(this.$emit("profileImageChanged"),this.$rootEvent.hideFullPageLoader(),e.isMessageSet()){let i=e.success?m.success:m.warning;this.$rootEvent.showNotification(i,e.message)}e.success&&c().refreshUserData()}))}}},[["render",function(e,i,a,o,l,r){const n=s("UploadDialog");return t(),h(n,{"is-visible":a.isVisible,"configuration-id":l.configurationId,onUploadFinished:r.onUploadFinished},null,8,["is-visible","configuration-id","onUploadFinished"])}],["__scopeId","data-v-48dfd41e"]]),EditPersonalDataDialog:e({setup:()=>({v$:A()}),data:()=>({username:(new p).getLoggedInUserData().username,loggedInUser:(new p).getLoggedInUserData(),violations:{username:[]}}),validations(){return{username:{required:E.withMessage(this.$t("validations.required"),$)}}},props:{isVisible:{type:Boolean,required:!1}},mixins:[I,l],components:{la:r,Modal:n,Username:e({data:()=>({firstname:null}),emits:["update:modelValue"],components:{Vinput:i},props:{violations:{type:Array,required:!0},modelValue:{required:!1}},created(){this.firstname=this.modelValue},watch:{modelValue(){this.firstname=this.modelValue}}},[["render",function(e,i,l,r,n,d){const u=s("Vinput");return t(),a("div",null,[o(u,{label:e.$t("userSettings.tab.baseData.children.personalData.form.userName.label"),type:"text",onInput:i[0]||(i[0]=i=>e.$emit("update:modelValue",i.target.value)),"is-required":!0,errors:l.violations,modelValue:n.firstname,"onUpdate:modelValue":i[1]||(i[1]=e=>n.firstname=e)},null,8,["label","errors","modelValue"])])}]]),MediumButtonWithIcon:d},methods:{saveBaseData(){if(!this.validateForm())return;let e={username:this.username},i=u.buildUrl(f.URL_USER_BASE_DATA_PERSONAL_SAVE);this.$rootEvent.showFullPageLoader(),this.$axios.post(i,e).then((async e=>{if(e.success){e.isMessageSet()&&this.$rootEvent.showNotification(m.success,e.message);let i=(new p).getLoggedInUserData();this.loggedInUser=i,await v.requestJwtTokenAndWaitForIt(),c().loadUserData()}this.$rootEvent.hideFullPageLoader()}))},validateForm(){return this.v$.$validate(),this.violations=this.vuelidateErrorsToPropsViolation(this.v$.$errors),0===Object.keys(this.violations).length}}},[["render",function(e,i,a,l,r,n){const d=s("MediumButtonWithIcon"),u=s("Username"),m=s("la"),c=s("Modal");return t(),h(c,{title:e.$t("userSettings.tab.baseData.children.personalData.modal.header"),"is-visible":a.isVisible,"is-vshow-visibility":!0,size:e.isPhoneBreakingPoint?"full":"medium"},{cancelButton:b((()=>[o(d,{text:e.$t("userSettings.tab.baseData.children.personalData.modal.button.close.label"),"is-mobile-full-width":!0,"margin-right-class":"mr-0",class:"px-2 sm:px-0",onClick:i[0]||(i[0]=i=>e.$emit("modalClosed"))},null,8,["text"])])),content:b((()=>[o(u,{modelValue:r.username,"onUpdate:modelValue":i[1]||(i[1]=e=>r.username=e),violations:r.violations.username},null,8,["modelValue","violations"]),o(d,{text:e.$t("userSettings.tab.baseData.children.personalData.form.submit.label"),"is-mobile-full-width":!0,onButtonClick:n.saveBaseData,class:"submit-button"},{icon:b((()=>[o(m,{"svg-icon-name":"save-solid","font-size":30,color:"white",class:"hover:opacity-50 cursor-pointer"})])),_:1},8,["text","onButtonClick"])])),_:1},8,["title","is-visible","size"])}]]),MediumButtonWithIcon:d,la:r,Row:D},mixins:[V],emits:["profileImageChanged"],methods:{showDetailsModal(){this.isDetailModalVisible=!0},hideDetailsModal(){this.isDetailModalVisible=!1}}},[["render",function(e,i,l,r,n,d){const u=s("fa"),m=s("MediumButtonWithIcon"),c=s("la"),h=s("Row"),g=s("EditPersonalDataDialog"),p=s("EmailAddressDialog"),v=s("ProfileImageUpload");return t(),a("div",null,[o(h,{"is-content-equally-distributed":!0,"flex-direction":e.rowFlexDirection},{default:b((()=>[o(m,{text:e.$t("userSettings.tab.baseData.children.personalData.label"),"is-icon-on-top":!0,onClick:i[0]||(i[0]=e=>n.isEditPersonalDataDialogVisible=!0),"button-classes":"settings-view-button"},{icon:b((()=>[o(u,{icon:"user"})])),_:1},8,["text"]),o(m,{text:e.$t("userSettings.tab.baseData.children.profileImage.label"),"is-icon-on-top":!0,onClick:i[1]||(i[1]=e=>n.isProfileImageModalVisible=!0),"button-classes":"settings-view-button"},{icon:b((()=>[o(c,{color:"white","svg-icon-name":"camera-retro-solid","font-size":"20"})])),_:1},8,["text"]),o(m,{text:e.$t("userSettings.tab.baseData.children.emailAddress.label"),"is-icon-on-top":!0,onClick:i[2]||(i[2]=e=>n.isEmailAddressDialogVisible=!0),"button-classes":"settings-view-button"},{icon:b((()=>[o(c,{color:"white","svg-icon-name":"envelope-open","font-size":"20"})])),_:1},8,["text"])])),_:1},8,["flex-direction"]),o(g,{"is-visible":n.isEditPersonalDataDialogVisible,onModalClosed:i[3]||(i[3]=e=>n.isEditPersonalDataDialogVisible=!1)},null,8,["is-visible"]),o(p,{"is-visible":n.isEmailAddressDialogVisible,onModalClosed:i[4]||(i[4]=e=>n.isEmailAddressDialogVisible=!1)},null,8,["is-visible"]),o(v,{"is-visible":n.isProfileImageModalVisible,onModalClosed:i[5]||(i[5]=e=>n.isProfileImageModalVisible=!1),onProfileImageChanged:i[6]||(i[6]=i=>e.$emit("profileImageChanged"))},null,8,["is-visible"])])}]]);export{x as default};
