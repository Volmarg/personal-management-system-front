import{_ as e}from"./ModuleBaseDataMixin.ba5b6395.js";import{M as t,_ as l}from"./ModuleWithFoldersSelect.ad9dc4a7.js";import{_ as o,M as i,a0 as s,a1 as a,r as d,o as n,e as r,h as c,k as u,I as m,f as p,aN as h,bk as f,t as b,aa as g,af as M,p as v,l as x,b5 as F,R as C,X as k,Y as $,j as y,n as S,g as D,aS as w,c as V,W as R,aI as B,aV as N,aA as W}from"./index.db8bde11.js";import{_}from"./ResponseHandlerMixin.67891b2e.js";import{a as I,b as q,S as A}from"./StorageState.8952430d.js";import{U as L,T as U}from"./UploadDialog.bfc03424.js";import{F as T,a as E}from"./FloatingBox.d0c09d8b.js";import{S as j}from"./SearchInput.ef99a9ef.js";import{P as z}from"./PublicFolderService.9fc40093.js";import{C as O}from"./ClipboardService.e68b9e1f.js";var P=o({data:()=>({showModal:!1,selectedModule:null,selectedPath:null}),props:{isModalVisible:{type:Boolean,required:!0,default:!1}},components:{MediumButtonWithIcon:i,Modal:s,ModuleWithFoldersSelect:t},mixins:[a,_],emits:["modalClosed","confirmClick"],computed:{selectedFiles:()=>I().selectedFilesData},methods:{onModalClosed(){this.$emit("modalClosed")},onSubmit(){let e=[];for(let o of this.selectedFiles){let t=o.name+(o.ext?`.${o.ext}`:"");e.push(t)}let t={fileNames:e,newDirPath:this.selectedPath,currDirPath:this.$route.query.dir},l=q.buildUrl(q.FILE_MOVE_URL);this.$axios.post(l,t).then((e=>{this.handleResponse(e)&&(I().clearSelectedFiles(),I().getAll(),this.$emit("modalClosed"))}))}},updated(){this.showModal=this.isModalVisible}},[["render",function(e,t,l,o,i,s){const a=d("ModuleWithFoldersSelect"),m=d("MediumButtonWithIcon"),p=d("Modal");return n(),r("div",null,[c(p,{"is-visible":i.showModal,title:e.$t("storage.page.module.moveModal.header"),onModalClosed:s.onModalClosed,onConfirm:s.onSubmit,size:e.modalSize},{content:u((()=>[c(a,{onModuleSelectChange:t[0]||(t[0]=e=>i.selectedModule=e),onFolderSelectChange:t[1]||(t[1]=e=>i.selectedPath=e)}),c(m,{text:e.$t("storage.page.module.moveModal.form.submit.label"),"button-extra-classes":"pt-3 pb-3 sm:pt-1 sm:pb-1",class:"w-full mb-1 md:col-start-1 md:col-end-2 mt-6","button-classes":"w-full md:w-auto m-0-force","text-classes":"text-center w-full",onButtonClick:s.onSubmit},null,8,["text","onButtonClick"])])),_:1},8,["is-visible","title","onModalClosed","onConfirm","size"])])}]]);const H={data:()=>({name:"",showModal:!1}),props:{isModalVisible:{type:Boolean,required:!0,default:!1}},components:{MediumButtonWithIcon:i,FormInput:m,Modal:s},mixins:[a,l],emits:["modalClosed","confirmClick"],methods:{onModalClosed(){this.$emit("modalClosed")},async onSubmit(){await this.addFolder(this.$route.query.dir,this.name,!0)&&(I().clearSelectedFiles(),I().getAll(),this.name="",this.$emit("modalClosed"))}},updated(){this.showModal=this.isModalVisible}},J={class:"flex justify-center"},G={class:"w-full flex flex-col"};var K=o(H,[["render",function(e,t,l,o,i,s){const a=d("FormInput"),m=d("MediumButtonWithIcon"),h=d("Modal");return n(),r("div",null,[c(h,{"is-visible":i.showModal,title:e.$t("storage.page.module.newFolderModal.header.label"),onModalClosed:s.onModalClosed,size:e.modalSize},{content:u((()=>[p("div",J,[p("div",G,[c(a,{type:"text","is-required":!0,label:e.$t("storage.page.module.newFolderModal.form.name.label"),modelValue:i.name,"onUpdate:modelValue":t[0]||(t[0]=e=>i.name=e)},null,8,["label","modelValue"]),c(m,{text:e.$t("storage.page.module.newFolderModal.form.submit.label"),"button-extra-classes":"pt-3 pb-3 sm:pt-1 sm:pb-1",class:"w-full mb-1 md:col-start-1 md:col-end-2 mt-6","button-classes":"w-full md:w-auto m-0-force","text-classes":"text-center w-full",onButtonClick:s.onSubmit},null,8,["text","onButtonClick"])])])])),_:1},8,["is-visible","title","onModalClosed","size"])])}]]);const X={emits:["modalClosed"],data:()=>({showModal:!1}),props:{isModalVisible:{type:Boolean,required:!0,default:!1}},components:{WarningModal:h,UnicodeArrow:f},mixins:[_,a],computed:{selectedFiles:()=>I().selectedFilesData},methods:{onModalClosed(){this.$emit("modalClosed")},onSubmit(){let e=[];for(let o of this.selectedFiles){let t=o.name+(o.ext?`.${o.ext}`:"");e.push(t)}let t={fileNames:e,dirPath:this.$route.query.dir},l=q.buildUrl(q.FILE_REMOVE_URL);this.$axios.post(l,t).then((e=>{this.handleResponse(e)&&(I().clearSelectedFiles(),I().getAll(),this.$emit("modalClosed"))}))}},updated(){this.showModal=this.isModalVisible}},Y={class:"mb-2"},Q=(le=()=>p("hr",null,null,-1),v("data-v-d03a1bfa"),le=le(),x(),le),Z={class:"flex justify-center flex-row"},ee={class:"files-list"},te={class:"file-name"};var le,oe=o(X,[["render",function(e,t,l,o,i,s){const a=d("UnicodeArrow"),m=d("WarningModal");return n(),r("div",null,[c(m,{"is-visible":i.showModal,title:e.$t("storage.page.module.removeModal.header.label"),onModalClosed:s.onModalClosed,onConfirm:s.onSubmit,size:e.modalSize},{content:u((()=>[p("p",Y,b(e.$t("storage.page.module.removeModal.description")),1),Q,p("div",Z,[p("ul",ee,[(n(!0),r(g,null,M(s.selectedFiles,(e=>(n(),r("li",{key:JSON.stringify(e),class:"flex flex-row"},[c(a,{class:"align-self-start mr-2"}),p("span",te,b(e.name)+" "+b(e.ext?`.${e.ext}`:""),1)])))),128))])])])),_:1},8,["is-visible","title","onModalClosed","onConfirm","size"])])}],["__scopeId","data-v-d03a1bfa"]]),ie=o({data:()=>({storageState:null,showModal:!1,description:"",initialSmallSizeModal:"medium"}),props:{isModalVisible:{type:Boolean,required:!0,default:!1}},components:{MediumButtonWithIcon:i,Wyswig:F,Modal:s},mixins:[a,_],emits:["modalClosed","confirmClick"],methods:{onModalClosed(){this.$emit("modalClosed")},onSubmit(){let e={moduleName:I().moduleName,description:this.description,dirPath:this.$route.query.dir},t=q.buildUrl(q.FOLDER_UPDATE_META_DATA);this.$axios.post(t,e).then((e=>{this.handleResponse(e)&&(I().clearSelectedFiles(),I().getAll(),this.$emit("modalClosed"))}))}},created(){this.storageState=I()},updated(){this.showModal=this.isModalVisible},watch:{"storageState.activeNodeData":{deep:!0,handler:function(){this.description=I().activeNodeData.description}}}},[["render",function(e,t,l,o,i,s){const a=d("Wyswig"),m=d("MediumButtonWithIcon"),p=d("Modal");return n(),r("div",null,[c(p,{"is-visible":i.showModal,title:e.$t("storage.page.module.settingsModal.header"),onModalClosed:s.onModalClosed,size:e.modalSize},{content:u((()=>[c(a,{"initial-value":i.description,label:e.$t("storage.page.module.settingsModal.form.description.label"),modelValue:i.description,"onUpdate:modelValue":t[0]||(t[0]=e=>i.description=e)},null,8,["initial-value","label","modelValue"]),c(m,{text:e.$t("storage.page.module.settingsModal.form.submit.label"),"button-extra-classes":"pt-3 pb-3 sm:pt-1 sm:pb-1",class:"w-full mb-1 md:col-start-1 md:col-end-2 mt-6","button-classes":"w-full md:w-auto m-0-force","text-classes":"text-center w-full",onButtonClick:s.onSubmit},null,8,["text","onButtonClick"])])),_:1},8,["is-visible","title","onModalClosed","size"])])}]]);const se={emits:["modalClosed"],data:()=>({showModal:!1}),props:{isModalVisible:{type:Boolean,required:!0,default:!1}},components:{WarningModal:h},mixins:[_,a],methods:{onModalClosed(){this.$emit("modalClosed")},onSubmit(){let e={dirPath:this.$route.query.dir},t=q.buildUrl(q.FOLDER_REMOVE_URL);this.$axios.post(t,e).then((e=>{this.handleResponse(e)&&(I().clearSelectedFiles(),I().getAll(),this.$emit("modalClosed"))}))}},updated(){this.showModal=this.isModalVisible}},ae={class:"mb-2"},de=["innerHTML"];var ne=o(se,[["render",function(e,t,l,o,i,s){const a=d("WarningModal");return n(),r("div",null,[c(a,{"is-visible":i.showModal,title:e.$t("storage.page.module.removeFolderModal.header.label"),onModalClosed:s.onModalClosed,onConfirm:s.onSubmit,size:e.modalSize},{content:u((()=>[p("p",ae,b(e.$t("storage.page.module.removeFolderModal.description.line1")),1),p("p",{class:"mb-2",innerHTML:e.$t("storage.page.module.removeFolderModal.description.line2")},null,8,de)])),_:1},8,["is-visible","title","onModalClosed","onConfirm","size"])])}]]),re=o({props:{isDisabled:{type:Boolean,default:!1}},components:{FloatingBox:T,FullRoundButtonWithIcon:E},emits:["click"],mixins:[_],computed:{isLocked:()=>I().activeNodeData.isLocked},methods:{toggleLock(){let e={dir:this.$route.query.dir,moduleName:I().moduleName},t=q.buildUrl(q.FOLDER_TOGGLE_LOCK_URL);this.$axios.post(t,e).then((e=>{this.handleResponse(e)&&(I().clearSelectedFiles(),I().getAll())}))}}},[["render",function(e,t,l,o,i,s){const a=d("fa"),r=d("FullRoundButtonWithIcon"),m=d("FloatingBox"),p=C("tippy");return k((n(),$(m,{"show-background":!1,onClick:t[0]||(t[0]=t=>e.$emit("click"))},{default:u((()=>[c(r,{"slide-able":!1,"background-color-class-name":s.isLocked?"bg-red-500":"bg-green-500",onClick:s.toggleLock},{icon:u((()=>[s.isLocked?(n(),$(a,{key:0,icon:"lock"})):(n(),$(a,{key:1,icon:"lock-open"}))])),_:1},8,["background-color-class-name","onClick"])])),_:1})),[[p,s.isLocked?e.$t("storage.nav.button.lock.unlock"):e.$t("storage.nav.button.lock.doLock")]])}]]),ce=o({components:{FloatingBox:T,FullRoundButtonWithIcon:E},emits:["click"]},[["render",function(e,t,l,o,i,s){const a=d("fa"),r=d("FullRoundButtonWithIcon"),m=d("FloatingBox"),p=C("tippy");return k((n(),$(m,{"show-background":!1,onClick:t[0]||(t[0]=t=>e.$emit("click"))},{default:u((()=>[c(r,{"slide-able":!1},{icon:u((()=>[c(a,{icon:"folder"}),c(a,{icon:"plus",class:"absolute -ml-5 mt-2.5 text-xs text-gray-500"})])),_:1})])),_:1})),[[p,e.$t("storage.nav.button.addFolder.label")]])}]]),ue=o({components:{FloatingBox:T,FullRoundButtonWithIcon:E},emits:["click"]},[["render",function(e,t,l,o,i,s){const a=d("fa"),r=d("FullRoundButtonWithIcon"),m=d("FloatingBox"),p=C("tippy");return k((n(),$(m,{"show-background":!1,onClick:t[0]||(t[0]=t=>e.$emit("click"))},{default:u((()=>[c(r,{"slide-able":!1},{icon:u((()=>[c(a,{icon:"upload"})])),_:1})])),_:1})),[[p,e.$t("storage.nav.button.uploadFile.label")]])}]]),me=o({components:{FloatingBox:T,FullRoundButtonWithIcon:E},emits:["click"]},[["render",function(e,t,l,o,i,s){const a=d("fa"),r=d("FullRoundButtonWithIcon"),m=d("FloatingBox"),p=C("tippy");return k((n(),$(m,{"show-background":!1,onClick:t[0]||(t[0]=t=>e.$emit("click"))},{default:u((()=>[c(r,{"slide-able":!1},{icon:u((()=>[c(a,{icon:"cog"})])),_:1})])),_:1})),[[p,e.$t("storage.nav.button.settings.label")]])}]]),pe=o({props:{isDisabled:{type:Boolean,default:!1}},components:{FloatingBox:T,FullRoundButtonWithIcon:E},emits:["click"]},[["render",function(e,t,l,o,i,s){const a=d("fa"),r=d("FullRoundButtonWithIcon"),m=d("FloatingBox"),p=C("tippy");return k((n(),$(m,{"show-background":!1,onClick:t[0]||(t[0]=t=>e.$emit("click"))},{default:u((()=>[c(r,{"slide-able":!1,"is-disabled":l.isDisabled,"background-color-class-name":"bg-red-500"},{icon:u((()=>[c(a,{icon:"trash"})])),_:1},8,["is-disabled"])])),_:1})),[[p,e.$t("storage.nav.button.delete.label")]])}]]),he=o({props:{isDisabled:{type:Boolean,default:!1}},components:{FloatingBox:T,FullRoundButtonWithIcon:E},emits:["click"]},[["render",function(e,t,l,o,i,s){const a=d("fa"),r=d("FullRoundButtonWithIcon"),m=d("FloatingBox"),p=C("tippy");return k((n(),$(m,{"show-background":!1,onClick:t[0]||(t[0]=t=>e.$emit("click"))},{default:u((()=>[c(r,{"slide-able":!1,"is-disabled":l.isDisabled},{icon:u((()=>[c(a,{icon:"random"})])),_:1},8,["is-disabled"])])),_:1})),[[p,e.$t("storage.nav.button.move.label")]])}]]),fe=o({data:()=>({uploadConfigId:I().uploadConfigId,isAddFolderModalVisible:!1,isRemoveFolderModalVisible:!1,isRemoveModalVisible:!1,isSettingsModalVisible:!1,isUploadModalVisible:!1,isMoveFilesModalVisible:!1}),components:{RemoveFolder:o({components:{FloatingBox:T,FullRoundButtonWithIcon:E},emits:["click"]},[["render",function(e,t,l,o,i,s){const a=d("fa"),r=d("FullRoundButtonWithIcon"),m=d("FloatingBox"),p=C("tippy");return k((n(),$(m,{"show-background":!1,onClick:t[0]||(t[0]=t=>e.$emit("click"))},{default:u((()=>[c(r,{"slide-able":!1,"background-color-class-name":"bg-red-500"},{icon:u((()=>[c(a,{icon:"folder"}),c(a,{icon:"minus",class:"absolute -ml-5 mt-2.5 text-xs text-gray-500"})])),_:1})])),_:1})),[[p,e.$t("storage.nav.button.removeFolder.label")]])}]]),RemoveFolderModal:ne,AddFolder:ce,UploadFile:ue,Settings:me,RemoveFiles:pe,TransferFiles:he,AddFolderModal:K,RemoveModal:oe,SettingsModal:ie,UploadDialog:L,MoveFilesModal:P,ToggleLock:re},computed:{isAnyFileSelected:()=>0!=I().selectedFilesData.length,uploadExtraData(){return{uploadDir:this.$route.query.dir}}}},[["render",function(e,t,l,o,i,s){const a=d("TransferFiles"),u=d("RemoveFiles"),m=d("ToggleLock"),p=d("UploadFile"),h=d("RemoveFolder"),f=d("AddFolder"),b=d("Settings"),M=d("AddFolderModal"),v=d("RemoveFolderModal"),x=d("RemoveModal"),F=d("SettingsModal"),C=d("MoveFilesModal"),k=d("UploadDialog");return n(),r(g,null,[c(a,{class:"mb-96","is-disabled":!s.isAnyFileSelected,onClick:t[0]||(t[0]=e=>s.isAnyFileSelected?i.isMoveFilesModalVisible=!0:null)},null,8,["is-disabled"]),c(u,{class:"mb-82","is-disabled":!s.isAnyFileSelected,onClick:t[1]||(t[1]=e=>s.isAnyFileSelected?i.isRemoveModalVisible=!0:null)},null,8,["is-disabled"]),c(m,{class:"mb-62"}),c(p,{class:"mb-48",onClick:t[2]||(t[2]=e=>i.isUploadModalVisible=!0)}),c(h,{class:"mb-30",onClick:t[3]||(t[3]=e=>i.isRemoveFolderModalVisible=!0)}),c(f,{class:"mb-20",onClick:t[4]||(t[4]=e=>i.isAddFolderModalVisible=!0)}),c(b,{class:"mb-6",onClick:t[5]||(t[5]=e=>i.isSettingsModalVisible=!0)}),c(M,{"is-modal-visible":i.isAddFolderModalVisible,onModalClosed:t[6]||(t[6]=e=>i.isAddFolderModalVisible=!1)},null,8,["is-modal-visible"]),c(v,{"is-modal-visible":i.isRemoveFolderModalVisible,onModalClosed:t[7]||(t[7]=e=>i.isRemoveFolderModalVisible=!1)},null,8,["is-modal-visible"]),c(x,{"is-modal-visible":i.isRemoveModalVisible,onModalClosed:t[8]||(t[8]=e=>i.isRemoveModalVisible=!1)},null,8,["is-modal-visible"]),c(F,{"is-modal-visible":i.isSettingsModalVisible,onModalClosed:t[9]||(t[9]=e=>i.isSettingsModalVisible=!1)},null,8,["is-modal-visible"]),c(C,{"is-modal-visible":i.isMoveFilesModalVisible,onModalClosed:t[10]||(t[10]=e=>i.isMoveFilesModalVisible=!1)},null,8,["is-modal-visible"]),c(k,{"is-visible":i.isUploadModalVisible,"configuration-id":i.uploadConfigId,"refresh-storage-state":!0,"extra-data":{uploadDir:e.$route.query.dir},onModalClosed:t[11]||(t[11]=e=>i.isUploadModalVisible=!1)},null,8,["is-visible","configuration-id","extra-data"])],64)}]]);const be={class:"node-level"},ge={class:"dir-name"},Me={class:"dirs-wrapper"},ve={class:"w-full"},xe={key:0},Fe={key:1,class:"flex flex-row flex-wrap"},Ce={key:2,class:"flex justify-center flex-col w-full p-5 align-self-center h-full"},ke={class:"flex justify-start flex-row flex-wrap -mt-5 mb-5"},$e={class:"text-lg text-left font-bold ml-2"},ye={class:"self-end text-tiny ml-2 mb-0.5"},Se={class:"flex justify-end mb-4"},De={class:"flex flex-row h-full"},we=["innerHTML"];var Ve=o({data:()=>({searchValue:""}),props:{dirsStructure:{type:Array,required:!0},folderContentClasses:{type:String,required:!1,default:"p-6"},routeName:{type:String,required:!0}},mixins:[e],emits:["visibleFilesChange"],components:{Container:B,FoldersTree:o({props:{dirsStructure:{type:Array,required:!0},routeName:{type:Array,required:!0}},components:{TreeNode:o({props:{storageRouteName:{type:String,required:!0},nodes:{type:Object,required:!0}},methods:{isNodeActive(e){return this.$route.query.dir==e.path},setActiveNodeData(e){this.isNodeActive(e)&&(I().activeNodeData=e)}}},[["render",function(e,t,l,o,i,s){const a=d("fa"),m=d("router-link"),h=d("TreeNode",!0);return n(),r("ul",be,[(n(!0),r(g,null,M(l.nodes,(e=>(n(),r("li",{key:JSON.stringify(e),class:"node-child"},[y(b(s.setActiveNodeData(e))+" ",1),c(m,{to:{to:l.storageRouteName,query:{dir:e.path}}},{default:u((()=>[p("span",{class:S(["node-child-data",{"locked-node-child-data":e.isLocked}])},[s.isNodeActive(e)?(n(),$(a,{key:0,icon:"folder-open",class:S(["folder-icon",{"active-folder-tree-node":s.isNodeActive(e),"locked-node":e.isLocked}])},null,8,["class"])):(n(),$(a,{key:1,icon:"folder",class:"folder-icon"})),p("span",ge,b(e.dirname),1)],2)])),_:2},1032,["to"]),e.children.length>0?(n(),$(h,{key:0,nodes:e.children,"storage-route-name":l.storageRouteName},null,8,["nodes","storage-route-name"])):D("",!0)])))),128))])}],["__scopeId","data-v-943244f2"]])}},[["render",function(e,t,l,o,i,s){const a=d("TreeNode");return n(),r("div",Me,[c(a,{nodes:l.dirsStructure,"storage-route-name":l.routeName},null,8,["nodes","storage-route-name"])])}],["__scopeId","data-v-75806bfc"]]),FolderContent:o({props:{folderContentClasses:{type:String,required:!1},searchValue:{type:String,required:!0}},components:{NoResultsText:w},emits:["visibleFilesChange"],computed:{visibleFiles(){var e;let t=[];if(!(null==(e=this.nodeData)?void 0:e.files))return[];if(V.isEmptyString(this.searchValue))return this.$emit("visibleFilesChange",this.nodeData.files),this.nodeData.files;for(let l of this.nodeData.files)(l.name+(l.ext?`.${l.ext}`:"")).includes(this.searchValue)&&t.push(l);return this.$emit("visibleFilesChange",t),t},nodeData:()=>I().activeNodeData}},[["render",function(e,t,l,o,i,s){const a=d("NoResultsText");return n(),r("div",ve,[s.visibleFiles.length>0?(n(),r("div",xe,[R(e.$slots,"description",{dirNodeData:s.nodeData})])):D("",!0),s.visibleFiles.length>0?(n(),r("div",Fe,[(n(!0),r(g,null,M(s.visibleFiles,(t=>(n(),r("div",{key:JSON.stringify(t),class:S(l.folderContentClasses)},[R(e.$slots,"singleFile",{fileData:t,dirNodeData:s.nodeData})],2)))),128))])):(n(),r("div",Ce,[c(a)]))])}]]),SideNav:fe,SearchInput:j},computed:{dirName(){var e;return null!=(e=this.$route.query.dir.split("/").reverse()[0])?e:""},activeNodeData:()=>I().activeNodeData},methods:{redirectToRootDir(){this.$nextTick((()=>{if(0===this.dirsStructure.length)return;let e=this.dirsStructure[0].path,t=null;for(let o of this.$route.matched)o.name===this.$route.name&&(t=o.path);let l=this.buildStorageUrl(e,t);document.querySelector(".active-folder-tree-node")||this.$router.push(l)}))}},beforeMount(){I().clearSelectedFiles()},updated(){I().clearSelectedFiles(),this.redirectToRootDir()},watch:{dirsStructure:{deep:!0,handler:function(){this.redirectToRootDir()}},"$route.query.dir"(){this.searchValue=""}}},[["render",function(e,t,l,o,i,s){const a=d("fa"),m=d("SearchInput"),h=d("FoldersTree"),f=d("FolderContent"),M=d("Container"),v=d("SideNav");return n(),r(g,null,[p("div",ke,[p("span",$e,[y(" > "),s.activeNodeData.isLocked?(n(),$(a,{key:0,icon:"lock",class:"text-red-500"})):(n(),$(a,{key:1,icon:"lock-open",class:"text-green-500"})),y(" "+b(s.dirName),1)]),p("span",ye," ("+b(e.$route.query.dir)+") ",1)]),p("div",Se,[c(m,{modelValue:i.searchValue,"onUpdate:modelValue":t[0]||(t[0]=e=>i.searchValue=e)},null,8,["modelValue"])]),c(M,{"extra-classes":"folder-container"},{default:u((()=>[R(e.$slots,"containerBeginning",{},void 0,!0),p("div",De,[c(h,{"dirs-structure":l.dirsStructure,"route-name":l.routeName,ref:"foldersTree"},null,8,["dirs-structure","route-name"]),c(f,{"folder-content-classes":l.folderContentClasses,"search-value":i.searchValue,onVisibleFilesChange:t[1]||(t[1]=t=>e.$emit("visibleFilesChange",t))},{description:u((({dirNodeData:e})=>[p("p",{class:"dir-description",innerHTML:e.description},null,8,we)])),singleFile:u((({fileData:t,dirNodeData:l})=>[R(e.$slots,"singleFile",{fileData:t,dirNodeData:l},void 0,!0)])),_:3},8,["folder-content-classes","search-value"])])])),_:3}),c(v)],64)}],["__scopeId","data-v-3012a128"]]);const Re={computed:{fileUrl(){return z.buildUrl(`${this.dirNodeData.path}/${this.fileData.name}.${this.fileData.ext}`)}}},Be={data:()=>({name:"",tags:[],showModal:!1}),props:{isModalVisible:{type:Boolean,required:!0,default:!1},fileData:{type:Object,required:!0}},components:{MediumButtonWithIcon:i,Modal:s,TagInput:U,FormInput:m},mixins:[_,a],emits:["modalClosed","updateSuccess"],methods:{onModalClosed(){this.$emit("modalClosed")},onSubmit(){let e=this.fileData.name,t=this.name;this.fileData.ext&&(e+=`.${this.fileData.ext}`,t+=`.${this.fileData.ext}`);let l={currFileName:e,newFileName:t,dirPath:this.$route.query.dir,tags:this.tags},o=q.buildUrl(q.FILE_UPDATE_URL);this.$axios.post(o,l).then((e=>{this.handleResponse(e)&&(I().getAll(),this.$emit("modalClosed"))}))}},updated(){this.showModal=this.isModalVisible,this.tags=this.fileData.tags,this.name=this.fileData.name}},Ne={class:"flex justify-center"},We={class:"w-full flex flex-col"},_e={data:()=>({textWrapperMaxWidth:"auto",isEditModalVisible:!1,isSelected:!1,filenameMaxLen:30}),props:{fileData:{type:Object,required:!0},dirNodeData:{type:Object,required:!0},moduleName:{type:String,required:!0},useImgWidthForTextWidth:{type:Boolean,required:!1,default:!1},selectOnFileRepresentationClick:{type:Boolean,required:!1,default:!0}},emits:["editClick"],mixins:[Re],components:{Checkbox:N,EditModal:o(Be,[["render",function(e,t,l,o,i,s){const a=d("FormInput"),m=d("TagInput"),h=d("MediumButtonWithIcon"),f=d("Modal");return n(),r("div",null,[c(f,{"is-visible":i.showModal,title:e.$t("storage.page.module.updateModal.header.label"),onModalClosed:s.onModalClosed,size:e.modalSize},{content:u((()=>[p("div",Ne,[p("div",We,[c(a,{type:"text","is-required":!0,label:e.$t("storage.page.module.updateModal.form.name.label"),modelValue:i.name,"onUpdate:modelValue":t[0]||(t[0]=e=>i.name=e)},null,8,["label","modelValue"]),c(m,{modelValue:i.tags,"onUpdate:modelValue":t[1]||(t[1]=e=>i.tags=e)},null,8,["modelValue"]),c(h,{text:e.$t("storage.page.module.updateModal.form.submit.label"),"button-extra-classes":"pt-3 pb-3 sm:pt-1 sm:pb-1",class:"w-full mb-1 md:col-start-1 md:col-end-2 mt-6","button-classes":"w-full md:w-auto m-0-force","text-classes":"text-center w-full",onButtonClick:s.onSubmit},null,8,["text","onButtonClick"])])])])),_:1},8,["is-visible","title","onModalClosed","size"])])}]])},computed:{fileName(){let e=this.fileData.name;return this.fileData.ext&&(e+=`.${this.fileData.ext}`),e.length<=this.filenameMaxLen?e:e.substr(0,this.filenameMaxLen)+"..."},hoverContent(){let e='<div class="in-hover-tags">';for(let t of this.fileData.tags)e+=`<span class='in-hover-tag'>${t}</span>`;return e+="</div>",`\n        <div class="hover-content-wrapper">\n          <b>${this.$t("storage.fileHoverData.text.fileName")}</b>: ${this.fileData.name} ${this.fileData.ext?"."+this.fileData.ext:""}\n          <br><br>\n          <b>${this.$t("storage.fileHoverData.text.size")}</b>: ${this.fileData.size}\n          <br><br>\n          <b>${this.$t("storage.fileHoverData.text.tags")}</b><br>\n          ${e}\n        </div>\n      `}},methods:{setTextWrapperMaxWidth(){this.useImgWidthForTextWidth||(this.textWrapperMaxWidth="auto"),this.moduleName!==A[A.images]?this.textWrapperMaxWidth=`${this.$refs.fileRepresentation.offsetWidth}px`:this.textWrapperMaxWidth=`${getComputedStyle(this.$refs.fileRepresentation.querySelector("img")).width}`},copyLink(){O.copyToClipboard(this.fileUrl)}},mounted(){this.setTextWrapperMaxWidth()},watch:{isSelected(){this.isSelected?I().selectFile(this.fileData):I().deselectFile(this.fileData)}}},Ie={class:"file-actions"},qe=["href"],Ae=["href"];var Le=o(_e,[["render",function(e,t,l,o,i,s){const a=d("Checkbox"),u=d("fa"),m=d("EditModal"),h=C("tippy");return n(),r("div",{class:S([{selected:i.isSelected},"file-base-main-wrapper"])},[p("div",null,[k((n(),r("div",{onClick:t[0]||(t[0]=t=>l.selectOnFileRepresentationClick?e.$refs.checkbox.toggle():null),class:"file-representation",ref:"fileRepresentation"},[R(e.$slots,"fileRepresentation")])),[[h,{content:s.hoverContent,position:"top",touch:!0}]]),p("div",{class:S(["file-name-wrapper",{[`file-name-wrapper-${l.moduleName}`]:!0}]),onClick:t[1]||(t[1]=t=>e.$refs.checkbox.toggle()),ref:"fileNameWrapper",style:W({"max-width":`${i.textWrapperMaxWidth} !important`})},b(s.fileName),7)]),p("div",Ie,[k(c(a,{class:"transform scale-75",modelValue:i.isSelected,"onUpdate:modelValue":t[2]||(t[2]=e=>i.isSelected=e),ref:"checkbox"},null,8,["modelValue"]),[[h,e.$t("storage.nav.button.select.label")]]),p("a",{href:e.fileUrl,download:""},[k(c(u,{icon:"download",class:"text-lg cursor-pointer hover:opacity-70 download"},null,512),[[h,e.$t("storage.nav.button.download.label")]])],8,qe),p("div",{href:e.fileUrl,onClick:t[3]||(t[3]=(...e)=>s.copyLink&&s.copyLink(...e))},[k(c(u,{icon:"link",class:"text-lg cursor-pointer hover:opacity-70"},null,512),[[h,e.$t("storage.nav.button.link.label")]])],8,Ae),k(c(u,{icon:"edit",class:"text-lg cursor-pointer hover:opacity-70 edit",onClick:t[4]||(t[4]=t=>{e.$emit("editClick"),i.isEditModalVisible=!0})},null,512),[[h,e.$t("storage.nav.button.edit.label")]])]),c(m,{"is-modal-visible":i.isEditModalVisible,"file-data":l.fileData,onModalClosed:t[5]||(t[5]=e=>i.isEditModalVisible=!1)},null,8,["is-modal-visible","file-data"])],2)}]]);export{Le as F,Re as _,Ve as a};
