import{C as e}from"./CategorySelect.9b85be0e.js";import{_ as t,M as a,I as s,aW as o,B as n,r as l,o as r,e as i,f as m,t as d,h as u,n as p,Y as c,k as h}from"./index.db8bde11.js";import{S as b,C as f}from"./CategoriesState.61218a0b.js";import{S as C}from"./SimpleTable.f571356e.js";import{B as S}from"./Base.b55dfd74.js";import{T as g}from"./TableActions.744b2f39.js";import"./SearchInput.ef99a9ef.js";import"./BrowserDetection.6a5570eb.js";import"./ColorBorderBar.86dcbce2.js";import"./ClipboardService.e68b9e1f.js";const P={class:"flex justify-center"},I={class:"text-lg text-center"};var w=t({data:()=>({form:{parentId:null,name:""}}),props:{header:{type:String,required:!0},formWrapperClasses:{type:String,required:!1,default:"md:w-1/2 lg:w-1/3 "},parentId:{type:[Number,null],required:!1,default:null},id:{type:[Number,null],required:!1,default:null},name:{type:String,required:!1,default:""}},components:{MediumButtonWithIcon:a,FormInput:s,CategorySelect:e},emits:["formSubmit"],methods:{clearFormData(){this.form.parentId=null,this.form.name=""},async onSubmit(){let e,t=new o(b.NOTES_CATEGORIES_BASE_URL,this.id,n,this.form);t.reload=!1,e=this.id?await this.$moduleCall.update(t):await this.$moduleCall.new(t),e.success&&(this.$emit("submit"),this.clearFormData())}},created(){this.form.name=this.name,this.form.parentId=this.parentId}},[["render",function(e,t,a,s,o,n){const c=l("FormInput"),h=l("CategorySelect"),b=l("MediumButtonWithIcon");return r(),i("div",P,[m("div",{class:p(["mt-6 w-full flex flex-col",{[a.formWrapperClasses]:!0}])},[m("h2",I,d(a.header),1),u(c,{type:"text",modelValue:o.form.name,"onUpdate:modelValue":t[0]||(t[0]=e=>o.form.name=e),"is-required":!0,label:e.$t("notes.settings.form.name.label")},null,8,["modelValue","label"]),u(h,{label:e.$t("notes.settings.form.parent.label"),modelValue:o.form.parentId,"onUpdate:modelValue":t[1]||(t[1]=e=>o.form.parentId=e)},null,8,["label","modelValue"]),u(b,{text:e.$t("notes.settings.form.submit.label"),"button-extra-classes":"pt-3 pb-3 sm:pt-1 sm:pb-1",class:"w-full mb-1 md:col-start-1 md:col-end-2 mt-6","button-classes":"w-full md:w-auto m-0-force","text-classes":"text-center w-full",onButtonClick:n.onSubmit},null,8,["text","onButtonClick"])],2)])}]]),v=t({data(){return{categoriesStore:null,categories:[],table:{headers:[{label:"id",dataValuePath:"id.value",isVisible:!1,dataIsComponentPath:null,dataComponentPropertiesPath:null},{label:"parentId",dataValuePath:"parentId.value",isVisible:!1,dataIsComponentPath:null,dataComponentPropertiesPath:null},{label:this.$t("notes.settings.table.header.name.label"),dataValuePath:"name.value",dataIsComponentPath:"name.isComponent",dataComponentPropertiesPath:null},{label:this.$t("notes.settings.table.header.parent.label"),dataValuePath:"parent.value",dataIsComponentPath:"parent.isComponent",dataComponentPropertiesPath:null},{label:this.$t("notes.settings.table.header.actions.label"),dataValuePath:"actions.value",dataIsComponentPath:"actions.isComponent",dataComponentPropertiesPath:"actions.componentProps"}]}}},components:{AddEditForm:w,SimpleTable:C,Base:S},computed:{usedTableData(){let e=[];for(let t of this.categories)e.push({values:{id:{value:t.id,isComponent:!1},parentId:{value:t.parentId,isComponent:!1},name:{value:t.name,isComponent:!1},parent:{value:t.parentName+(t.isParentDeleted?` (${this.$t("notes.settings.text.isDeleted")})`:""),isComponent:!1},actions:{value:g,isComponent:!0,componentProps:{editActionForm:w,baseUrl:b.NOTES_CATEGORIES_BASE_URL,store:f}}}});return e}},methods:{async refreshPage(){await this.categoriesStore.getAll(),this.categories=this.categoriesStore.allEntries},onNewSubmit(){this.refreshPage()}},beforeMount(){this.categoriesStore=f()},watch:{"categoriesStore.allEntries":{deep:!0,handler:function(){this.categories=this.categoriesStore.allEntries}}}},[["render",function(e,t,a,s,o,n){const i=l("SimpleTable"),m=l("AddEditForm"),d=l("Base");return r(),c(d,{"info-block-description":e.$t("notes.settings.description")},{default:h((()=>[u(i,{headers:o.table.headers,data:n.usedTableData},null,8,["headers","data"]),u(m,{onSubmit:n.onNewSubmit,header:e.$t("notes.settings.form.header.new")},null,8,["onSubmit","header"])])),_:1},8,["info-block-description"])}]]);export{v as default};
