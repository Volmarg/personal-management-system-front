import{A as e,a as t,B as a}from"./Base.88a7709f.js";import{aE as l,aF as n,_ as o,aK as s,r,o as i,Y as m,M as d,I as u,aW as p,B as b,e as h,f as c,t as f,h as y,aS as C,n as g,aa as P,af as v,k as w,aY as S}from"./index.93e753e6.js";import{S as V}from"./SymfonyPaymentsRoutes.8ab93abb.js";import{S as A}from"./SimpleTable.2176e307.js";import{T as B}from"./TableActions.b19e3a52.js";import"./BrowserDetection.6a5570eb.js";import"./ColorBorderBar.99bb35e7.js";import"./SearchInput.c3a3a680.js";import"./ClipboardService.32914954.js";const D=l("paymentBillsState",{state:()=>({allEntries:[]}),actions:{async getAll(){this.allEntries=await(new n).getAll(V.BILLS_BASE_URL)}}}),I={class:"flex justify-center mt-10"},$={class:"mt-6 md:w-1/2 lg:w-1/3 w-full flex flex-col"},x={class:"text-lg"};var F=o({data:()=>({form:{date:null,name:null,billId:null,amount:null}}),props:{header:{type:String,required:!1,default:""},id:{type:[Number,null],required:!1,default:null},date:{type:[String,null],required:!1,default:null},amount:{type:[Number,null],required:!1,default:null},name:{type:[String,null],required:!1,default:null},billId:{type:[Number,null],required:!1,default:null}},components:{BillSelect:o({data:()=>({store:null,bills:[],selected:null}),components:{MultiSelect:s},emits:["change"],computed:{options(){let e=[];for(let t of this.bills)e.push({label:`${t.name} (${t.startDate} - ${t.endDate})`,value:t.id});return e}},methods:{onOptionChanged(e){this.selected=e,this.$emit("update:modelValue",e),this.$emit("change",e)}},async beforeMount(){this.store=D(),await this.store.getAll(),this.bills=this.store.allEntries}},[["render",function(e,t,a,l,n,o){const s=r("MultiSelect");return i(),m(s,{label:e.$t("payments.bills.overview.newForm.bill.label"),options:o.options,onChange:o.onOptionChanged,onSelect:o.onOptionChanged,onDeselect:o.onOptionChanged,onClear:o.onOptionChanged,onPaste:o.onOptionChanged,modelValue:n.selected,"onUpdate:modelValue":t[0]||(t[0]=e=>n.selected=e),mode:"single","allow-show-options-list":!0,"allow-create-options":!1,"can-clear":!0,required:!0,ref:"multiselect"},null,8,["label","options","onChange","onSelect","onDeselect","onClear","onPaste","modelValue"])}]]),MediumButtonWithIcon:d,FormInput:u},methods:{clearForm(){this.form.date=null,this.form.name=null,this.form.billId=null,this.form.amount=null},async onSubmit(){let e,t=new p(V.BILLS_ITEMS_BASE_URL,this.id,b,this.form);t.reload=!1,e=this.id?await this.$moduleCall.update(t):await this.$moduleCall.new(t),e.success&&(this.$emit("submit"),this.clearForm())}},beforeMount(){this.form.date=this.date,this.form.name=this.name,this.form.billId=this.billId,this.form.amount=this.amount}},[["render",function(e,t,a,l,n,o){const s=r("FormInput"),m=r("BillSelect"),d=r("MediumButtonWithIcon");return i(),h("div",I,[c("div",$,[c("h2",x,f(a.header),1),y(s,{type:"text",modelValue:n.form.name,"onUpdate:modelValue":t[0]||(t[0]=e=>n.form.name=e),"is-required":!0,label:e.$t("payments.bills.overview.newForm.name.label")},null,8,["modelValue","label"]),y(s,{type:"number",modelValue:n.form.amount,"onUpdate:modelValue":t[1]||(t[1]=e=>n.form.amount=e),"is-required":!0,label:e.$t("payments.bills.overview.newForm.amount.label")},null,8,["modelValue","label"]),y(s,{type:"date",modelValue:n.form.date,"onUpdate:modelValue":t[2]||(t[2]=e=>n.form.date=e),"is-required":!0,label:e.$t("payments.bills.overview.newForm.date.label")},null,8,["modelValue","label"]),y(m,{modelValue:n.form.billId,"onUpdate:modelValue":t[3]||(t[3]=e=>n.form.billId=e)},null,8,["modelValue"]),y(d,{text:e.$t("payments.bills.overview.newForm.submit.label"),"button-extra-classes":"pt-3 pb-3 sm:pt-1 sm:pb-1",class:"w-full mb-1 md:col-start-1 md:col-end-2 mt-6","button-classes":"w-full md:w-auto m-0-force","text-classes":"text-center w-full",onButtonClick:o.onSubmit},null,8,["text","onButtonClick"])])])}]]),T=o({data(){return{allYears:[],yearFilter:null,headers:[{label:"id",dataValuePath:"id.value",isVisible:!1,dataIsComponentPath:null,dataComponentPropertiesPath:null},{label:"billId",dataValuePath:"billId.value",isVisible:!1,dataIsComponentPath:null,dataComponentPropertiesPath:null},{label:this.$t("payments.bills.overview.elementTable.header.amount.label"),dataValuePath:"amount.value",dataIsComponentPath:"amount.isComponent",dataComponentPropertiesPath:null},{label:this.$t("payments.bills.overview.elementTable.header.name.label"),dataValuePath:"name.value",dataIsComponentPath:"name.isComponent",dataComponentPropertiesPath:null},{label:this.$t("payments.bills.overview.elementTable.header.date.label"),dataValuePath:"date.value",dataIsComponentPath:"date.isComponent",dataComponentPropertiesPath:null},{label:this.$t("payments.bills.overview.elementTable.header.actions.label"),dataValuePath:"actions.value",dataIsComponentPath:"actions.isComponent",dataComponentPropertiesPath:"actions.componentProps"}]}},props:{data:{type:Array,required:!0}},components:{NoResultsText:C,SimpleTable:A}},[["render",function(e,t,a,l,n,o){const s=r("SimpleTable"),d=r("NoResultsText");return a.data.length>0?(i(),m(s,{key:0,headers:n.headers,data:a.data,ref:"table",class:"mt-4"},null,8,["headers","data"])):(i(),m(d,{key:1}))}]]),q=o({props:{planned:{type:Number,required:!0},spend:{type:Number,required:!0}},computed:{stateBgColor(){return this.spend>this.planned?"bg-red-500":this.spend>=.75*this.planned?"bg-orange-500":"bg-green-500"}}},[["render",function(e,t,a,l,n,o){return i(),h("span",{class:g({[o.stateBgColor]:!0,marker:!0})},null,2)}],["__scopeId","data-v-18b1fdd9"]]);const k={data:()=>({allBills:[],store:null}),props:{data:{type:Array,require:!0}},components:{AddEditForm:F,NoResultsText:C,Accordion:e,AccordionPanel:t,BillElementsTable:T,BillMarker:q},methods:{getBillTableData(e,t){let a=[];for(let l of e)a.push({values:{id:{value:l.id,isComponent:!1},billId:{value:t,isComponent:!1},amount:{value:l.amount,isComponent:!1},date:{value:l.date,isComponent:!1},name:{value:l.name,isComponent:!1},actions:{value:B,isComponent:!0,componentProps:{editActionForm:F,baseUrl:V.BILLS_ITEMS_BASE_URL,store:D}}}});return a},getSpentAmount(e){let t=0;for(let a of e)t+=a.amount;return t},async refreshPageState(){await this.store.getAll(),this.allBills=this.store.allEntries}},async beforeMount(){this.store=D(),this.refreshPageState()}},E={key:0,class:"mt-10"},_={class:"flex flex-wrap justify-start flex-row"},M=c("hr",{class:"mt-10 mb-5"},null,-1);var N=o(k,[["render",function(e,t,a,l,n,o){const s=r("BillMarker"),d=r("BillElementsTable"),u=r("AccordionPanel"),p=r("Accordion"),b=r("NoResultsText"),C=r("AddEditForm");return i(),h(P,null,[a.data.length>0?(i(),h("div",E,[(i(!0),h(P,null,v(a.data,(e=>(i(),m(p,{key:JSON.stringify(e)},{default:w((()=>[y(u,{class:"accordion-panel","initially-open":!1},{title:w((()=>[c("div",_,[y(s,{planned:e.plannedAmount,spend:o.getSpentAmount(e.elements),class:"mt-1"},null,8,["planned","spend"]),c("span",null,f(e.name)+" - "+f(o.getSpentAmount(e.elements))+" / "+f(e.plannedAmount)+" ("+f(e.startDate)+" - "+f(e.endDate)+")",1)])])),content:w((()=>[y(d,{data:o.getBillTableData(e.elements,e.id),class:"mb-5"},null,8,["data"])])),_:2},1024)])),_:2},1024)))),128))])):(i(),m(b,{key:1})),M,y(C,{header:e.$t("payments.bills.overview.newForm.header"),onSubmit:o.refreshPageState},null,8,["header","onSubmit"])],64)}]]);const U={class:"flex justify-center mt-10"},L={class:"mt-6 md:w-1/2 lg:w-1/3 w-full flex flex-col"},R={class:"text-lg"};var j=o({data:()=>({form:{startDate:null,endDate:null,name:null,information:null,plannedAmount:null}}),props:{header:{type:String,required:!1,default:""},id:{type:[Number,null],required:!1,default:null},startDate:{type:[String,null],required:!1,default:null},endDate:{type:[String,null],required:!1,default:null},name:{type:[String,null],required:!1,default:null},information:{type:[String,null],required:!1,default:null},plannedAmount:{type:[Number,null],required:!1,default:null}},components:{MediumButtonWithIcon:d,FormInput:u},methods:{clearForm(){this.form.startDate=null,this.form.endDate=null,this.form.name=null,this.form.information=null,this.form.plannedAmount=null},async onSubmit(){let e,t=new p(V.BILLS_BASE_URL,this.id,b,this.form);t.reload=!1,e=this.id?await this.$moduleCall.update(t):await this.$moduleCall.new(t),e.success&&(this.$emit("submit"),this.clearForm())}},beforeMount(){this.form.startDate=this.startDate,this.form.endDate=this.endDate,this.form.name=this.name,this.form.information=this.information,this.form.plannedAmount=this.plannedAmount}},[["render",function(e,t,a,l,n,o){const s=r("FormInput"),m=r("MediumButtonWithIcon");return i(),h("div",U,[c("div",L,[c("h2",R,f(a.header),1),y(s,{type:"text",modelValue:n.form.name,"onUpdate:modelValue":t[0]||(t[0]=e=>n.form.name=e),"is-required":!0,label:e.$t("payments.bills.management.newForm.name.label")},null,8,["modelValue","label"]),y(s,{type:"text",modelValue:n.form.information,"onUpdate:modelValue":t[1]||(t[1]=e=>n.form.information=e),"is-required":!0,label:e.$t("payments.bills.management.newForm.information.label")},null,8,["modelValue","label"]),y(s,{type:"number",modelValue:n.form.plannedAmount,"onUpdate:modelValue":t[2]||(t[2]=e=>n.form.plannedAmount=e),"is-required":!0,label:e.$t("payments.bills.management.newForm.plannedAmount.label")},null,8,["modelValue","label"]),y(s,{type:"date",modelValue:n.form.startDate,"onUpdate:modelValue":t[3]||(t[3]=e=>n.form.startDate=e),"is-required":!0,label:e.$t("payments.bills.management.newForm.startDate.label")},null,8,["modelValue","label"]),y(s,{type:"date",modelValue:n.form.endDate,"onUpdate:modelValue":t[4]||(t[4]=e=>n.form.endDate=e),"is-required":!0,label:e.$t("payments.bills.management.newForm.endDate.label")},null,8,["modelValue","label"]),y(m,{text:e.$t("payments.bills.management.newForm.submit.label"),"button-extra-classes":"pt-3 pb-3 sm:pt-1 sm:pb-1",class:"w-full mb-1 md:col-start-1 md:col-end-2 mt-6","button-classes":"w-full md:w-auto m-0-force","text-classes":"text-center w-full",onButtonClick:o.onSubmit},null,8,["text","onButtonClick"])])])}]]);const O={data:()=>({store:null}),props:{data:{type:Array,require:!0}},components:{NoResultsText:C,BillsTable:o({data(){return{allYears:[],yearFilter:null,headers:[{label:"id",dataValuePath:"id.value",isVisible:!1,dataIsComponentPath:null,dataComponentPropertiesPath:null},{label:this.$t("payments.bills.management.table.header.name.label"),dataValuePath:"name.value",dataIsComponentPath:"name.isComponent",dataComponentPropertiesPath:null},{label:this.$t("payments.bills.management.table.header.information.label"),dataValuePath:"information.value",dataIsComponentPath:"information.isComponent",dataComponentPropertiesPath:null},{label:this.$t("payments.bills.management.table.header.plannedAmount.label"),dataValuePath:"plannedAmount.value",dataIsComponentPath:"plannedAmount.isComponent",dataComponentPropertiesPath:null},{label:this.$t("payments.bills.management.table.header.startDate.label"),dataValuePath:"startDate.value",dataIsComponentPath:"startDate.isComponent",dataComponentPropertiesPath:null},{label:this.$t("payments.bills.management.table.header.endDate.label"),dataValuePath:"endDate.value",dataIsComponentPath:"endDate.isComponent",dataComponentPropertiesPath:null},{label:this.$t("payments.bills.management.table.header.actions.label"),dataValuePath:"actions.value",dataIsComponentPath:"actions.isComponent",dataComponentPropertiesPath:"actions.componentProps"}]}},props:{data:{type:Array,required:!0}},components:{NoResultsText:C,SimpleTable:A}},[["render",function(e,t,a,l,n,o){const s=r("SimpleTable"),d=r("NoResultsText");return a.data.length>0?(i(),m(s,{key:0,headers:n.headers,data:a.data,ref:"table",class:"mt-4"},null,8,["headers","data"])):(i(),m(d,{key:1}))}]]),AddEditForm:j},computed:{tableData(){let e=[];for(let t of this.data)e.push({values:{id:{value:t.id,isComponent:!1},startDate:{value:t.startDate,isComponent:!1},endDate:{value:t.endDate,isComponent:!1},name:{value:t.name,isComponent:!1},information:{value:t.information,isComponent:!1},plannedAmount:{value:t.plannedAmount,isComponent:!1},actions:{value:B,isComponent:!0,componentProps:{editActionForm:j,baseUrl:V.BILLS_BASE_URL,store:D}}}});return e}},methods:{async refreshPageState(){await this.store.getAll()}},async beforeMount(){this.store=D(),this.refreshPageState()}},W={key:0,class:"mt-10"},Y=c("hr",{class:"mt-10 mb-5"},null,-1);var J=o(O,[["render",function(e,t,a,l,n,o){const s=r("BillsTable"),d=r("NoResultsText"),u=r("AddEditForm");return i(),h(P,null,[o.tableData.length>0?(i(),h("div",W,[y(s,{data:o.tableData},null,8,["data"])])):(i(),m(d,{key:1})),Y,y(u,{header:e.$t("payments.bills.management.newForm.header"),onSubmit:o.refreshPageState},null,8,["header","onSubmit"])],64)}]]);const K={class:"flex justify-start flex-col text-left"},z={class:"text-lg font-bold"},G={class:"mt-2"},H={class:"mark-color-info"},Q={class:"mark-color-info"},X={class:"mark-color-info"};var Z=o({components:{BillMarker:q}},[["render",function(e,t,a,l,n,o){const s=r("BillMarker");return i(),h("div",K,[c("p",z,f(e.$t("payments.bills.legend.billColor.header")),1),c("ul",G,[c("li",null,[y(s,{planned:100,spend:30}),c("span",H,f(e.$t("payments.bills.legend.billColor.ok")),1)]),c("li",null,[y(s,{planned:100,spend:80}),c("span",Q,f(e.$t("payments.bills.legend.billColor.warn")),1)]),c("li",null,[y(s,{planned:100,spend:120}),c("span",X,f(e.$t("payments.bills.legend.billColor.exceed")),1)])])])}],["__scopeId","data-v-83f161fa"]]),ee=o({data:()=>({store:null,billsData:[]}),components:{Tabs:S,Base:a},computed:{tabsContent(){return[{tabName:this.$t("payments.bills.tab.overview.label"),tabComponent:N,tabComponentProps:{data:this.billsData}},{tabName:this.$t("payments.bills.tab.management.label"),tabComponent:J,tabComponentProps:{data:this.billsData}},{tabName:this.$t("payments.bills.tab.legend.label"),tabComponent:Z}]}},async beforeMount(){this.store=D(),await this.store.getAll(),this.billsData=this.store.allEntries},watch:{"store.allEntries":{deep:!0,handler:function(){this.billsData=this.store.allEntries}}}},[["render",function(e,t,a,l,n,o){const s=r("Tabs"),d=r("Base");return i(),m(d,{"info-block-description":e.$t("payments.bills.description"),"is-in-container":!1},{default:w((()=>[y(s,{"tabs-with-content":o.tabsContent},null,8,["tabs-with-content"])])),_:1},8,["info-block-description"])}]]);export{ee as default};
