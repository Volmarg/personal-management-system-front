import{B as e}from"./Base.4cd7396b.js";import{_ as t,aK as a,c as o,r as l,o as s,Y as r,aE as n,aF as u,aZ as i,e as d,h as m,M as h,I as p,aW as f,B as c,f as b,t as y,aS as g,aa as C,af as V,aY as w,aI as P,k as S}from"./index.31c62b28.js";import{S as x}from"./SymfonyJobRoutes.3769096f.js";import{S as j}from"./SimpleTable.e8a83743.js";import{T as $}from"./TableActions.891cb007.js";import"./BrowserDetection.6a5570eb.js";import"./ColorBorderBar.d18aa733.js";import"./SearchInput.7d75b069.js";import"./ClipboardService.126585e6.js";var v=t({data(){return{types:["made","spent"],selectOptions:[],selectedValue:this.modelValue}},props:{modelValue:{required:!1}},components:{MultiSelect:a},computed:{options(){let e=[];for(let t of this.types)e.push({label:o.ucFirst(t),value:t});return e}},methods:{onOptionChanged(e){this.selectedValue=e,this.$emit("update:modelValue",e)}},watch:{modelValue(){this.selectedValue=this.modelValue}}},[["render",function(e,t,a,o,n,u){const i=l("MultiSelect");return s(),r(i,{label:e.$t("job.afterhours.new.form.type.label"),options:u.options,onChange:u.onOptionChanged,onSelect:u.onOptionChanged,onDeselect:u.onOptionChanged,onClear:u.onOptionChanged,onPaste:u.onOptionChanged,modelValue:n.selectedValue,"onUpdate:modelValue":t[0]||(t[0]=e=>n.selectedValue=e),mode:"single","allow-show-options-list":!0,"allow-create-options":!1,required:!0},null,8,["label","options","onChange","onSelect","onDeselect","onClear","onPaste","modelValue"])}]]);const A=n("jobAfterhoursState",{state:()=>({allEntries:[]}),actions:{async getAll(){this.allEntries=await(new u).getAll(x.AFTERHOURS_BASE_URL)}}}),T={class:"flex justify-center"},I={class:"mt-6 md:w-1/2 lg:w-1/3 w-full flex flex-col"},q={class:"text-lg mb-2"};var E=t({data:()=>({form:{date:null,description:null,minutes:null,goal:null,type:null}}),props:{header:{type:String,required:!1,default:""},id:{type:[Number,null],required:!1,default:null},type:{type:[String,null],required:!1,default:null},date:{type:[String,null],required:!1,default:null},description:{type:[String,null],required:!1,default:null},minutes:{type:[String,null],required:!1,default:null},goal:{type:[String,null],required:!1,default:null}},components:{GoalInput:t({data(){return{selectedValue:[this.modelValue],afterhours:[],store:null}},props:{modelValue:{required:!1}},components:{MultiSelect:a},computed:{options(){let e=[],t=[];for(let a of this.afterhours)i.isNull(a.goal)||t.includes(a.goal)||(t.push(a.goal),e.push({label:a.goal,value:a.goal}));return e}},methods:{onOptionChanged(e){this.selectedValue=[e],this.$emit("update:modelValue",e)}},async created(){this.store=A(),await this.store.getAll(),this.afterhours=this.store.allEntries},watch:{"store.allEntries":{deep:!0,handler:function(){this.afterhours=this.store.allEntries}},modelValue(){this.selectedValue=this.modelValue}}},[["render",function(e,t,a,o,r,n){const u=l("MultiSelect");return s(),d("div",null,[m(u,{label:e.$t("job.afterhours.new.form.goal.label"),options:n.options,onChange:n.onOptionChanged,onSelect:n.onOptionChanged,onDeselect:n.onOptionChanged,onClear:n.onOptionChanged,onPaste:n.onOptionChanged,modelValue:r.selectedValue,"onUpdate:modelValue":t[0]||(t[0]=e=>r.selectedValue=e),mode:"tags","max-options":"1","allow-show-options-list":!0,"allow-create-options":!0},null,8,["label","options","onChange","onSelect","onDeselect","onClear","onPaste","modelValue"])])}]]),TypeSelect:v,MediumButtonWithIcon:h,FormInput:p},methods:{clearForm(){this.form.date=null,this.form.description=null,this.form.minutes=null,this.form.goal=null,this.form.type=null},async onSubmit(){let e={...this.form};i.isArray(e.goal)&&(e.goal=e.goal[0]);let t,a=new f(x.AFTERHOURS_BASE_URL,this.id,c,e);a.reload=!1,t=this.id?await this.$moduleCall.update(a):await this.$moduleCall.new(a),t.success&&(this.$emit("submit"),this.clearForm())}},beforeMount(){this.form.date=this.date,this.form.description=this.description,this.form.minutes=this.minutes,this.form.goal=this.goal,this.form.type=this.type}},[["render",function(e,t,a,o,r,n){const u=l("FormInput"),i=l("GoalInput"),h=l("TypeSelect"),p=l("MediumButtonWithIcon");return s(),d("div",T,[b("div",I,[b("h2",q,y(a.header),1),m(u,{type:"date",modelValue:r.form.date,"onUpdate:modelValue":t[0]||(t[0]=e=>r.form.date=e),"is-required":!0,label:e.$t("job.afterhours.new.form.date.label")},null,8,["modelValue","label"]),m(u,{type:"text",modelValue:r.form.description,"onUpdate:modelValue":t[1]||(t[1]=e=>r.form.description=e),"is-required":!0,label:e.$t("job.afterhours.new.form.description.label")},null,8,["modelValue","label"]),m(u,{type:"number",modelValue:r.form.minutes,"onUpdate:modelValue":t[2]||(t[2]=e=>r.form.minutes=e),"is-required":!0,label:e.$t("job.afterhours.new.form.minutes.label")},null,8,["modelValue","label"]),m(i,{modelValue:r.form.goal,"onUpdate:modelValue":t[3]||(t[3]=e=>r.form.goal=e),class:"mb-6"},null,8,["modelValue"]),m(h,{modelValue:r.form.type,"onUpdate:modelValue":t[4]||(t[4]=e=>r.form.type=e),class:"mb-6"},null,8,["modelValue"]),m(p,{text:e.$t("job.afterhours.new.form.submit.label"),"button-extra-classes":"pt-3 pb-3 sm:pt-1 sm:pb-1",class:"w-full mb-1 md:col-start-1 md:col-end-2 mt-6","button-classes":"w-full md:w-auto m-0-force","text-classes":"text-center w-full",onButtonClick:n.onSubmit},null,8,["text","onButtonClick"])])])}]]),F=t({data(){return{targetSelectOptions:[],headers:[{label:"id",dataValuePath:"id.value",isVisible:!1,dataIsComponentPath:null,dataComponentPropertiesPath:null},{label:"type",dataValuePath:"type.value",isVisible:!1,dataIsComponentPath:null,dataComponentPropertiesPath:null},{label:this.$t("job.afterhours.shared.table.headers.date.label"),dataValuePath:"date.value",dataIsComponentPath:"date.isComponent",dataComponentPropertiesPath:null},{label:this.$t("job.afterhours.shared.table.headers.description.label"),dataValuePath:"description.value",dataIsComponentPath:"description.isComponent",dataComponentPropertiesPath:null},{label:this.$t("job.afterhours.shared.table.headers.minutes.label"),dataValuePath:"minutes.value",dataIsComponentPath:"minutes.isComponent",dataComponentPropertiesPath:null},{label:this.$t("job.afterhours.shared.table.headers.goal.label"),dataValuePath:"goal.value",dataIsComponentPath:"goal.isComponent",dataComponentPropertiesPath:null},{label:this.$t("job.afterhours.shared.table.headers.actions.label"),dataValuePath:"actions.value",dataIsComponentPath:"actions.isComponent",dataComponentPropertiesPath:"actions.componentProps"}]}},props:{afterhours:{type:Array,required:!0}},components:{NoResultsText:g,SimpleTable:j},computed:{usedData(){let e=[];for(let t of this.afterhours)e.push({values:{id:{value:t.id,isComponent:!1},type:{value:t.type,isComponent:!1},date:{value:t.date,isComponent:!1},description:{value:t.description,isComponent:!1},minutes:{value:t.minutes,isComponent:!1},goal:{value:t.goal,isComponent:!1},actions:{value:$,isComponent:!0,componentProps:{editActionForm:E,baseUrl:x.AFTERHOURS_BASE_URL,store:A}}}});return e}}},[["render",function(e,t,a,o,n,u){const i=l("SimpleTable"),d=l("NoResultsText");return u.usedData.length>0?(s(),r(i,{key:0,headers:n.headers,data:u.usedData,ref:"table"},null,8,["headers","data"])):(s(),r(d,{key:1}))}]]),M=t({props:{afterhours:{type:Array,required:!0}},components:{AfterhoursTable:F}},[["render",function(e,t,a,o,n,u){const i=l("AfterhoursTable");return s(),r(i,{afterhours:a.afterhours},null,8,["afterhours"])}]]),O=t({props:{afterhours:{type:Array,required:!0}},components:{AfterhoursTable:F}},[["render",function(e,t,a,o,n,u){const i=l("AfterhoursTable");return s(),r(i,{afterhours:a.afterhours},null,8,["afterhours"])}]]);const R={class:"mt-10"},U=["innerHTML"],B={class:"mb-4 mt-8"},D={class:"font-bold text-lg text-left"},k={class:"flex flex-row"},_={class:"text-left font-bold text-blue-500"},H={class:"flex flex-row"},L={class:"text-left font-bold text-blue-500"};var N=t({data:()=>({workDayHours:8}),computed:{daysLabel(){return o.ucFirst(this.$t("job.afterhours.tabs.summary.texts.days.label"))},sumPerGoal(){let e={};for(let a of this.afterhours){let t=a.goal?a.goal:this.$t("job.afterhours.tabs.summary.texts.generalUsage");e[t]||(e[t]=0),"spent"!=a.type?e[t]+=a.minutes:e[t]-=a.minutes}let t={};for(let a in e){let o=e[a],l=parseInt(o/60),s=Math.abs(o%60),r=(o/60/this.workDayHours).toFixed(2);t[a]=`${l}h ${s}min (${r} ${this.$t("job.afterhours.tabs.summary.texts.days.label")})`}return t},totalMinutes(){let e=0;for(let t of this.afterhours)"spent"!=t.type?e+=t.minutes:e-=t.minutes;return e.toFixed(2)},humanReadableTime(){return`${parseInt(this.totalMinutes/60)}h ${Math.abs(this.totalMinutes%60)}min`},humanReadableDays(){return parseInt(this.totalMinutes/60/this.workDayHours).toFixed(2)}},props:{afterhours:{type:Array,required:!0}}},[["render",function(e,t,a,o,r,n){const u=l("fa");return s(),d("div",R,[(s(!0),d(C,null,V(n.sumPerGoal,((t,a)=>(s(),d("div",{key:a+t,class:"text-left mt-0.5"},[m(u,{icon:"caret-right"}),b("span",{innerHTML:e.$t("job.afterhours.tabs.summary.texts.gotForUsage",{time:t,goal:a})},null,8,U)])))),128)),b("div",B,[b("p",D,y(e.$t("job.afterhours.tabs.summary.texts.totally.header")),1),b("div",k,[m(u,{icon:"caret-right"}),b("span",null,y(e.$t("job.afterhours.tabs.summary.texts.hours.label"))+": ",1),b("span",_,y(n.humanReadableTime),1)]),b("div",H,[m(u,{icon:"caret-right"}),b("span",null,y(n.daysLabel)+": ",1),b("span",L,y(n.humanReadableDays),1)])])])}]]),G=t({data:()=>({store:null,afterhours:[]}),components:{Tabs:w,Container:P,Base:e,AddEditForm:E},computed:{tabsContent(){return[{tabName:this.$t("job.afterhours.tabs.summary.label"),tabComponent:N,tabComponentProps:{afterhours:this.afterhours}},{tabName:this.$t("job.afterhours.tabs.made.label"),tabComponent:M,tabComponentProps:{afterhours:this.afterhours.filter((e=>"made"==e.type))}},{tabName:this.$t("job.afterhours.tabs.spent.label"),tabComponent:O,tabComponentProps:{afterhours:this.afterhours.filter((e=>"spent"==e.type))}}]}},async beforeMount(){this.store=A(),await this.store.getAll(),this.afterhours=this.store.allEntries},watch:{"store.allEntries":{deep:!0,handler:function(){this.afterhours=this.store.allEntries}}}},[["render",function(e,t,a,o,n,u){const i=l("Tabs"),d=l("Container"),h=l("AddEditForm"),p=l("Base");return s(),r(p,{"info-block-description":e.$t("job.afterhours.description"),"is-in-container":!1},{default:S((()=>[m(d,null,{default:S((()=>[m(i,{"tabs-with-content":u.tabsContent},null,8,["tabs-with-content"])])),_:1}),m(d,{class:"mt-4"},{default:S((()=>[m(h,{onSubmit:n.store.getAll,header:e.$t("job.afterhours.new.form.header")},null,8,["onSubmit","header"])])),_:1})])),_:1},8,["info-block-description"])}]]);export{G as default};
