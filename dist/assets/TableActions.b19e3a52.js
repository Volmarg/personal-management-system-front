import{_ as e,aN as t,a1 as o,r as i,o as r,e as a,h as d,k as l,f as s,t as n,aZ as c,a_ as p,d as u,R as m,X as h,W as f,Y as b,a$ as y,aa as C,a0 as S,ag as v,az as M,g as q,c as D,a2 as g,n as w}from"./index.93e753e6.js";import{C as A}from"./ClipboardService.32914954.js";const F={emits:["modalClosed","removeConfirmClick"],data:()=>({showModal:!1}),props:{isModalVisible:{type:Boolean,required:!0,default:!1},handledData:{type:Object,required:!0}},components:{WarningModal:t},mixins:[o],computed:{},methods:{onModalClosed(){this.$emit("modalClosed")}},updated(){this.showModal=this.isModalVisible}},R={class:"text-center"},$={data:()=>({initialisedStore:null}),props:{fetchAll:{type:Boolean,required:!1,default:!0},store:{type:[Object,null,Array],required:!1,default:null}},computed:{useStoreFetch(){let e=c.isArray(this.store)&&!p.isEmpty(this.store)||this.store;return this.fetchAll&&e}},methods:{validateStoreFetchConf(){if(this.useStoreFetch||u.error("Re-fetching for delete is not possible with current configuration!",{fetchAll:this.fetchAll,store:this.store}),c.isArray(this.store)){this.initialisedStore=[];for(let e of this.store){let t=e();this.validateSingleStore(t),this.initialisedStore.push(t)}}else this.initialisedStore=this.store(),this.validateSingleStore(this.initialisedStore)},validateSingleStore(e){if(this.useStoreFetch&&!e.getAll)throw new Error("Store has no method named `getAll`");if(this.useStoreFetch&&!e.allEntries)throw new Error("Store has no property named `allEntries`")},fetchStoreData(){if(c.isArray(this.initialisedStore))for(let e of this.initialisedStore)e.getAll();else this.initialisedStore.getAll()}}};var I=e({data:()=>({isRemoveModalVisible:!1}),props:{recordId:{type:Number,required:!0},baseUrl:{type:String,required:!0}},mixins:[$],components:{RemoveModal:e(F,[["render",function(e,t,o,c,p,u){const m=i("WarningModal");return r(),a("div",null,[d(m,{"is-visible":p.showModal,title:e.$t("generic.action.remove.dialog.header"),onModalClosed:u.onModalClosed,onConfirm:t[0]||(t[0]=t=>e.$emit("removeConfirmClick")),size:e.modalSize},{content:l((()=>[s("p",R,n(e.$t("components.modal.text.removeRecord")),1)])),_:1},8,["is-visible","title","onModalClosed","size"])])}]])},methods:{async onRemoveConfirm(){this.validateStoreFetchConf(),await this.$moduleCall.remove(this.baseUrl,this.recordId,!this.useStoreFetch),this.useStoreFetch&&(this.fetchStoreData(),this.$refs.modal.onModalClosed())}}},[["render",function(e,t,o,l,s,n){const c=i("RemoveModal"),p=m("tippy");return r(),a(C,null,[h((r(),a("div",{onClick:t[0]||(t[0]=e=>s.isRemoveModalVisible=!0)},[f(e.$slots,"representation")])),[[p,{content:e.$t("components.actions.remove.label"),placement:"top"}]]),(r(),b(y,{to:"body"},[d(c,{"is-modal-visible":s.isRemoveModalVisible,"handled-data":e.handledData,onModalClosed:t[1]||(t[1]=e=>s.isRemoveModalVisible=!1),onRemoveConfirmClick:n.onRemoveConfirm,ref:"modal"},null,8,["is-modal-visible","handled-data","onRemoveConfirmClick"])]))],64)}]]);const k={data:()=>({showModal:!1,initialSmallSizeModal:"medium"}),props:{isModalVisible:{type:Boolean,required:!0,default:!1},handledData:{type:Object,required:!0}},components:{Modal:S},mixins:[o],emits:["modalClosed","formSubmit"],methods:{onModalClosed(){this.$emit("modalClosed")}},updated(){this.showModal=this.isModalVisible}};var V=e({data:()=>({isEditModalVisible:!1}),props:{handledData:{type:Object,required:!0},baseUrl:{type:String,required:!0},form:{type:[Object,null],required:!0},recordId:{type:Number,required:!0},parentRecordId:{type:[Number,null],required:!1,default:null}},components:{EditModal:e(k,[["render",function(e,t,o,s,n,c){const p=i("Modal");return r(),a("div",null,[d(p,{"is-visible":n.showModal,title:e.$t("generic.action.edit.dialog.header"),onModalClosed:c.onModalClosed,size:e.modalSize},{content:l((()=>[f(e.$slots,"form")])),_:3},8,["is-visible","title","onModalClosed","size"])])}]])},mixins:[$],methods:{onFormSubmit(){this.validateStoreFetchConf(),this.useStoreFetch&&(this.fetchStoreData(),this.$refs.modal.onModalClosed())}}},[["render",function(e,t,o,s,n,c){const p=i("EditModal"),u=m("tippy");return r(),a(C,null,[h((r(),a("div",{onClick:t[0]||(t[0]=e=>n.isEditModalVisible=!0)},[f(e.$slots,"representation")])),[[u,{content:e.$t("components.actions.edit.label"),placement:"top"}]]),(r(),b(y,{to:"body"},[d(p,{"is-modal-visible":n.isEditModalVisible,"handled-data":o.handledData,onModalClosed:t[1]||(t[1]=e=>n.isEditModalVisible=!1),ref:"modal"},{form:l((()=>[o.form?(r(),b(v(o.form),M({key:0,onFormSubmit:c.onFormSubmit,onSubmit:c.onFormSubmit},{...o.handledData}),null,16,["onFormSubmit","onSubmit"])):q("",!0)])),_:1},8,["is-modal-visible","handled-data"])]))],64)}]]);const E={props:{canEdit:{type:Boolean,required:!1,default:!0},canDelete:{type:Boolean,required:!1,default:!0},canCopyToClipboard:{type:Boolean,required:!1,default:!1},copiedDataKey:{type:String,required:!1},actionsWrapperClasses:{type:String,required:!1,default:""},handledData:{type:Object,required:!0},editForm:{type:[Object,null],required:!0},isModule:{type:Boolean,required:!1,default:!0,validator(e){if(!e)throw new g("Actions are currently supported only for modules!");return!0}},baseUrl:{type:String,required:!0},recordId:{type:Number,required:!0},parentRecordId:{type:[Number,null],required:!1,default:null},fetchAll:{type:Boolean,required:!1,default:!0},store:{type:[Object,null,Array],required:!1,default:null}},components:{CopyToClipboard:e({props:{copiedDataKey:{type:String,required:!0},handledData:{type:Object,required:!0}},mixins:[$],methods:{async copyToClipboard(){if(D.isEmptyString(this.copiedDataKey))throw new g("Copied data key is empty! Did You forget to pass it via prop?");A.copyToClipboard(this.handledData[this.copiedDataKey])}}},[["render",function(e,t,o,i,d,l){const s=m("tippy");return h((r(),a("div",{onClick:t[0]||(t[0]=(...e)=>l.copyToClipboard&&l.copyToClipboard(...e))},[f(e.$slots,"representation")])),[[s,{content:e.$t("components.actions.copy.label"),placement:"top"}]])}]]),Delete:I,Edit:V}},j={data(){return{parentRecordId:null,usedUpdateUrl:this.editUrl,usedDeleteUrl:this.deleteUrl}},props:{rowData:{type:Object,required:!0},editActionForm:{type:[Object,null],required:!0},identifierFieldName:{type:[String,null],required:!1,default:null},canCopyToClipboard:{type:Boolean,required:!1,default:!1},copiedDataKey:{type:String,required:!1},isModule:{type:Boolean,required:!1,default:!0,validator(e){if(!e)throw new g("Table actions are currently supported only for modules!");return!0}},baseUrl:{type:String,required:!0},fetchAll:{type:Boolean,required:!1,default:!0},store:{type:[Object,null,Array],required:!1,default:null}},mixins:[{methods:{getValueFromSource(e,t){var o;let i=t.find((t=>t[e.identifierName]===e.identifierValue));return i&&null!=(o=i[e.sourceValue])?o:null}}}],components:{Actions:e(E,[["render",function(e,t,o,d,s,n){const c=i("Edit"),p=i("Delete"),u=i("CopyToClipboard");return r(),a("div",{class:w({[o.actionsWrapperClasses]:!0})},[o.canEdit?(r(),b(c,{key:0,"handled-data":o.handledData,form:o.editForm,"base-url":o.baseUrl,"record-id":o.recordId,"parent-record-id":o.parentRecordId,"fetch-all":o.fetchAll,store:o.store},{form:l((()=>[f(e.$slots,"editForm")])),representation:l((()=>[f(e.$slots,"editRepresentation")])),_:3},8,["handled-data","form","base-url","record-id","parent-record-id","fetch-all","store"])):q("",!0),o.canDelete?(r(),b(p,{key:1,"handled-data":o.handledData,"base-url":o.baseUrl,"record-id":o.recordId,"fetch-all":o.fetchAll,store:o.store},{representation:l((()=>[f(e.$slots,"deleteRepresentation")])),_:3},8,["handled-data","base-url","record-id","fetch-all","store"])):q("",!0),o.canCopyToClipboard?(r(),b(u,{key:2,"handled-data":o.handledData,"copied-data-key":o.copiedDataKey},{representation:l((()=>[f(e.$slots,"copyToClipboardRepresentation")])),_:3},8,["handled-data","copied-data-key"])):q("",!0)],2)}]])},computed:{recordId(){let e=Object.values(this.rowData),t=e.find((e=>"id"==e.fieldId||"identifier"==e.fieldId));if(!t&&this.identifierFieldName&&(t=e.find((e=>e.fieldId==this.identifierFieldName))),!t)throw new g("Could not determine record id for table actions",{rowData:this.rowData});return t.rawValue},formData(){let e={};for(let t of this.rowData)e[t.fieldId]=t.rawValue;return e}}},T={class:"button bg-red-500"},x={class:"button bg-blue-500"},O={class:"button bg-blue-500"};var U=e(j,[["render",function(e,t,o,a,n,c){const p=i("fa"),u=i("Actions");return r(),b(u,{"actions-wrapper-classes":"flex flex-row gap-x-1","handled-data":c.formData,"record-id":c.recordId,"edit-form":o.editActionForm,"is-module":o.isModule,"base-url":o.baseUrl,"parent-record-id":n.parentRecordId,"fetch-all":o.fetchAll,store:o.store,"can-copy-to-clipboard":o.canCopyToClipboard,"copied-data-key":o.copiedDataKey},{deleteRepresentation:l((()=>[s("div",T,[d(p,{icon:"trash"})])])),editRepresentation:l((()=>[s("div",x,[d(p,{icon:"edit"})])])),copyToClipboardRepresentation:l((()=>[s("div",O,[d(p,{icon:"copy",class:"ml-0.5"})])])),_:1},8,["handled-data","record-id","edit-form","is-module","base-url","parent-record-id","fetch-all","store","can-copy-to-clipboard","copied-data-key"])}],["__scopeId","data-v-2f356313"]]);export{U as T};
